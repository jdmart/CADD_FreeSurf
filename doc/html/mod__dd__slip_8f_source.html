<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CADD: Disl/mod_dd_slip.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CADD
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_71d6d02813a87235db486645a8c7b3c6.html">Disl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mod_dd_slip.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mod__dd__slip_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html">   11</a></span>&#160;      <span class="keyword">module</span> <a class="code" href="namespacemod__dd__slip.html">mod_dd_slip</a></div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a89adbbfc977cdad8339914640fd86804">   12</a></span>&#160;      <span class="keywordtype">integer</span>  <a class="code" href="namespacemod__dd__slip.html#a6ebc2746ce470503e03c1a07a8e14359">mxnslp</a>, <a class="code" href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mxnsys</a>, <a class="code" href="namespacemod__dd__slip.html#a89adbbfc977cdad8339914640fd86804">nsys</a>, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a6ebc2746ce470503e03c1a07a8e14359">mxnslp</a>=50000)</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mxnsys</a>=3)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a343d0dd2938aa21a57d02d2d9205434b">   19</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a9bf7b9791d9dfcff4ab77df9f36964f7">dtime_dd</a>, <a class="code" href="namespacemod__dd__slip.html#a343d0dd2938aa21a57d02d2d9205434b">tnuc</a>, <a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a>, <a class="code" href="namespacemod__dd__slip.html#a1b284310d5cc3c40691c731783186435">tincr_sav</a></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a343d0dd2938aa21a57d02d2d9205434b">tnuc</a> = 1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-9)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a1b284310d5cc3c40691c731783186435">tincr_sav</a> = 1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-11)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">   27</a></span>&#160;      <span class="keywordtype">integer</span> ::  <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(<a class="code" href="namespacemod__dd__slip.html#a6ebc2746ce470503e03c1a07a8e14359">mxnslp</a>)</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">   28</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemod__dd__slip.html#a5dfead2bf24b6b827b7d9d4b8a4735e8">nntot</a>,<a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a>,<a class="code" href="namespacemod__dd__slip.html#ad8ebdc112d561b2fc072a77bc9528ced">n_active_slip</a> <span class="comment">!! 1/100 of all slip planes</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a8592c181e3e838e42e3c1804fd576a72">   29</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a8592c181e3e838e42e3c1804fd576a72">process_xmin</a>, <a class="code" href="namespacemod__dd__slip.html#a28c51187b58901a027c3d317b617e86f">process_xmax</a>,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;     $     process_ymin, process_ymax, process_area</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">   31</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">source_den</a>, <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a>,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;     $     sd_source_str</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">   33</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a>, <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;     $     atom_ymin, atom_ymax</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a09285994f0bef9b100c7f09eb93cb0f1">   35</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a2ae10fac283054525708028b9d53377b">e_dd</a>, <a class="code" href="namespacemod__dd__slip.html#abe71ffef9dd3a578892bd99f57144604">mu_dd</a>, <a class="code" href="namespacemod__dd__slip.html#a09285994f0bef9b100c7f09eb93cb0f1">nu_dd</a></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">   36</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#ab4337df8fb73c06f644b9362e7087084">phisys</a>, <a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(<a class="code" href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mxnsys</a>), <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mxnsys</a>), </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;     &amp;                    cosphi(<a class="code" href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mxnsys</a>)</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">   38</a></span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(:), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(:),<a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(:),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;     &amp;                                yendslp(:)</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">   40</a></span>&#160;      <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a>(:)</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a57e6d391a6bd2870b02b5b0738872a17">   41</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a57e6d391a6bd2870b02b5b0738872a17">elem_slip</a>(:)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aa9b6bdf8069606d789cdd50a14fc71fb">   43</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemod__dd__slip.html#aa9b6bdf8069606d789cdd50a14fc71fb">slipspc</a>, <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(3)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#aa9b6bdf8069606d789cdd50a14fc71fb">slipspc</a> = 100)</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#afb06abfdeadc119811107f8deddaceef">   45</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#ac780b1944516254958ea2ef99067fcef">dx_slip</a>, <a class="code" href="namespacemod__dd__slip.html#afb06abfdeadc119811107f8deddaceef">dy_slip</a></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">   46</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a>, <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!      common/slpsys/phisys,phislp,nsys</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!      common/sliphi/locphi,sinphi,cosphi</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!      common/slipxy/xslp,yslp,nslp</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!      common/slipend/xendslp, yendslp</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!    Nculeation common block       </span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">   53</a></span>&#160;      <span class="keywordtype">integer</span> ::  <a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">   54</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(:)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a> = 100)</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a83d7aa286ea628f8388281a435d91ce6">   56</a></span>&#160;      <span class="keywordtype">double precision</span>::  <a class="code" href="namespacemod__dd__slip.html#ad0c0e918c73157f9ed34c0dd8bb9a4c1">bdrag</a>, <a class="code" href="namespacemod__dd__slip.html#a83d7aa286ea628f8388281a435d91ce6">xle</a>, <a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>, <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>, <a class="code" href="namespacemod__dd__slip.html#af027841fa78ddf728bb416e19b0c9cc1">tobs</a>, <a class="code" href="namespacemod__dd__slip.html#ae8eae8e7db9f581f4a38d204a2a6465c">dstar</a>, <a class="code" href="namespacemod__dd__slip.html#a219c9587e77839191feb3723d12fb263">vcutoff</a>,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     &amp;                    tref, htinc, epsx, epss</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a219c9587e77839191feb3723d12fb263">vcutoff</a> = 1e13) <span class="comment">! A/s</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#ad0c0e918c73157f9ed34c0dd8bb9a4c1">bdrag</a> = 5.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-15) <span class="comment">! ev/A^3 s</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!      parameter(Bdrag = 0.0d0) ! ev/A^3 s</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">   62</a></span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(:,:), <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(:,:),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;     &amp;                    tnlaps(:,:), taui(:,:),snuc(:,:), rnuc(:,:,:)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!      double precision, allocatable :: nuc_pk_stress(:,:), nuc_pk_force(:,:)</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">   65</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(:,:)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!      Obstacles common block</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a5d4c38eb284cfad22a15acc8f44d89c2">   68</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemod__dd__slip.html#a5d4c38eb284cfad22a15acc8f44d89c2">tot_obs</a>, <a class="code" href="namespacemod__dd__slip.html#a30016ebf6324cc82865b0d84417a4b68">mxnobs</a></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a30016ebf6324cc82865b0d84417a4b68">mxnobs</a>=100)</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">   70</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(:)</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">   71</a></span>&#160;      <span class="keywordtype">double precision</span>,<span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a>(:,:), <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(:,:)</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">   72</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a>, <a class="code" href="namespacemod__dd__slip.html#af785590a174c8a5a974a979785d965f7">lobs_max</a>, <a class="code" href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">lobs_min</a> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!     (obstacle spacing Angstroms)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!      common/dprop/Bdrag,xLe,d,blen,tau_obs,dstar,vcutoff</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!      common/nuclea/nnuc,snuc</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!      common/nucles/t_FR,xLnuc</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!      common/nuclock/tnlaps</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!      common/timpar/tref,tincr,htinc,epsx,epss,tnuc</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!      common/frankr/taui</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!c     Dislocations Common block </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">   84</a></span>&#160;      <span class="keywordtype">integer</span>  :: <a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>, <a class="code" href="namespacemod__dd__slip.html#a40bc2094f8ea058c8b7eb0f1e667eb35">npile</a>, <a class="code" href="namespacemod__dd__slip.html#aa43723c6228da6af36b5ef1950e0e06b">nd</a>, <a class="code" href="namespacemod__dd__slip.html#a26d5920aca346c3ed3de15f7391a3392">nloop</a>, <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">   85</a></span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> ::  <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(:)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      parameter(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a> = 100)</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">   87</a></span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> ::  <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(:,:), <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(:,:),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;     &amp;                    vprev(:,:), bout(:,:),sdis_out(:,:),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;     $     sdis_out1(:,:)</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">   90</a></span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(:,:,:), <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(:,:,:)</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a53c50dfaacd2acedac0f46fc0070f557">   91</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a53c50dfaacd2acedac0f46fc0070f557">rpile</a>, <a class="code" href="namespacemod__dd__slip.html#ac8bbc8f48c207c01d23b3f230298835f">dlim</a></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a7629f451a880c9b11533488ab813a05e">   92</a></span>&#160;      <span class="keywordtype">integer</span>,<span class="keywordtype">allocatable</span> :: <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(:,:), <a class="code" href="namespacemod__dd__slip.html#a7629f451a880c9b11533488ab813a05e">jcnpin</a>(:,:), <a class="code" href="namespacemod__dd__slip.html#ab51ae4b35cb40e72a5fb4301b820d1b1">idple</a>(:,:),</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     $     elem_dis(:,:)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; <span class="comment">!     common/disl/ndis,sdis,idple</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; <span class="comment">!     common/disv/vprev</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; <span class="comment">!     common/burger/b_dd</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">!    common/pindis/iobpin,jcnpin</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">!    common/dpile/rpile,npile,nd,nloop</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">!    common/nuclim/dlim</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a0726e292080c2a677f6bf3131e85b41e">  103</a></span>&#160;      <span class="keywordtype">integer</span> :: <a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a0bf223b3567d76ff14185978469edd1a">  105</a></span>&#160;      <span class="keywordtype">double precision</span> :: <a class="code" href="namespacemod__dd__slip.html#a0bf223b3567d76ff14185978469edd1a">range_</a></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html">  106</a></span>&#160;      <span class="keyword">type</span> <a class="code" href="structmod__dd__slip_1_1dd.html">dd</a></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#ac992fd5fb45d6d8abe35859a431eb1c7">  109</a></span>&#160;      <span class="keywordtype">double complex</span> :: xy</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#ac8ced8cafcf6a813fc6d45d43aecc768">  110</a></span>&#160;      <span class="keywordtype">double precision</span> :: slipangle</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a7e86be437514827bc540a2fb49bd9bea">  111</a></span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(3)</span> :: burgers_dd</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#acf890fea27e8252da7c3d540033f7faa">  112</a></span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(3)</span> :: stress</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a2408b98737f751134e5cbb75cb06dba0">  114</a></span>&#160;      <span class="keywordtype">double complex</span> :: force, forced, disp, dispd, velocity,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     $     forcedg, forceg</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a6791541a7a9dbc46fe9b8d41c070cdc3">  120</a></span>&#160;        <span class="keywordtype">double complex</span>  :: alpha, alpha1, alpha2, alpha3, alpha4</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     $               , alpha5, alpha6, alpha7</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">! --- Gradient Direct terms</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#af1c4b13e3675c2334090b084d66e6146">  123</a></span>&#160;        <span class="keywordtype">double complex</span>  :: alpha1g, alpha2g, bialphag,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     $               beta1g, beta2g, bibetag</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#af5e333aea62eb15cabc6f5d6f3ea0e53">  125</a></span>&#160;        <span class="keywordtype">double complex</span>  :: alphad1, betad1, alphad2,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     $               betad2</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#aa34eb89f8a9fc610acfc0bf8082e6482">  127</a></span>&#160;        <span class="keywordtype">double complex</span>  :: beta, beta1, beta2, beta3,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;     $               beta4, beta5, beta6, beta7</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a55ab735bd06d648df3633c44499ae7cc">  129</a></span>&#160;        <span class="keywordtype">double complex</span>  :: bialpha, bibeta, phi1,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     $               phi2, phi11, phid1</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">! --- Gradient terms</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a62299f5403ed5750da7c10f05f09ccaf">  133</a></span>&#160;        <span class="keywordtype">double complex</span>  :: phi1g, phi2g, phi11g</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a792cf33a0321904264912461a900ae2d">  134</a></span>&#160;        <span class="keywordtype">double complex</span>  :: dphi1, dphi2, dphi11, dphid1</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structmod__dd__slip_1_1dd.html#a11d44e11c35f87d4d34f8bf4c75c2af1">  135</a></span>&#160;        integer     :: stype, slipplane_no</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">        end type </span><a class="code" href="structmod__dd__slip_1_1dd.html">dd</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keyword">contains</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aebab0eb78f3f219f189a6dadd9f58cd5">gen_slip_planes</a>(xmin, xmax,ymin,ymax,</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aebab0eb78f3f219f189a6dadd9f58cd5">  143</a></span>&#160;     &amp;     atomxmin, atomxmax, atomymin,atomymax, slip_angle,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     &amp;     burg_len, xslip_start,yslip_start,dxslip, dyslip, pad_width)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">double precision</span> :: xmin, xmax, ymin, ymax, burg_len</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">double precision</span> :: atomxmin, atomymin, atomxmax, atomymax</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">double precision</span> :: xslip_start, yslip_start, dxslip, dyslip</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">double precision</span> :: slip_angle(3)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!     Local Variables </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp,ii,nshift, jslp, li,lj</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">double precision</span> :: xstart, ystart, xend, yend, tmp</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">double precision</span> :: xi,xj</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">double precision</span> :: pad_width</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;c      <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a> = pad_width</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;c      <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a> = pad_width/2.0d0</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a> = 6.0d0</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a> = <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a9bf7b9791d9dfcff4ab77df9f36964f7">dtime_dd</a> = 0.0d0</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a89adbbfc977cdad8339914640fd86804">nsys</a> = 3</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ac780b1944516254958ea2ef99067fcef">dx_slip</a> = dxslip</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#afb06abfdeadc119811107f8deddaceef">dy_slip</a> = dyslip</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      print *, <span class="stringliteral">&#39;---------------------------------------&#39;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      print *, <span class="stringliteral">&#39;Generating slip planes&#39;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      print *, xmin, xmax, atomxmin, atomxmax</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      print *, ymin, ymax, atomymin, atomymax</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      print *, slip_angle(1), slip_angle(2), slip_angle(3)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      print *, burg_len</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      print *, dxslip, dyslip</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      print *, xslip_start, yslip_start</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      print *, <span class="stringliteral">&#39;---------------------------------------&#39;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">!     Generate bottom and top halves separately ? </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">!     Currently it is set up so that both are generated separately</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!     to account for the crack face </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a8592c181e3e838e42e3c1804fd576a72">process_xmin</a> = 0.75*xmin</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a28c51187b58901a027c3d317b617e86f">process_xmax</a> = 0.75*xmax</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      process_ymin = 0.75*ymin</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      process_ymax = 0.75*ymax</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      xmin = 0.75*xmin</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      xmax = 0.75*xmax</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      ymin = 0.75*ymin</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      ymax = 0.75*ymax</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      process_area = (<a class="code" href="namespacemod__dd__slip.html#a28c51187b58901a027c3d317b617e86f">process_xmax</a> - <a class="code" href="namespacemod__dd__slip.html#a8592c181e3e838e42e3c1804fd576a72">process_xmin</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     $     *(process_ymax-process_ymin) <span class="comment">! Angstrom^2</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a> = atomxmin</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a> = atomxmax</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      atom_ymin = atomymin</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      atom_ymax = atomymax</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a> = burg_len</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a83d7aa286ea628f8388281a435d91ce6">xle</a> = 6.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a> = 0</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(i) = slip_angle(i)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         cosphi(i) = cos(slip_angle(i))</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(i) = sin(slip_angle(i))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;         print *, <span class="stringliteral">&#39;Slip angle&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(i)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;         <span class="keywordflow">if</span> (i .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            tmp = ymax/abs(tan(slip_angle(i)))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = 2*int((xmax-xmin)/dxslip)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = 2*int((ymax)/(dyslip))</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a> = <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a> + <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         print *, <span class="stringliteral">&#39;No. of slip systems =&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      print *, <span class="stringliteral">&#39;Total no. of slip systems&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),<a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),yendslp(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a57e6d391a6bd2870b02b5b0738872a17">elem_slip</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a> = 0.0d0</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a> = 0.0d0</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a> = 0.0d0</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      yendslp = 0.0d0</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!     Now actually generate slip_planes through the whole sample</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">!     Count the actual no. of slip planes and compare with nslp</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         <span class="keywordflow">if</span> (i .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (i == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               xstart = xmin + dxslip</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">!     ystart is hard coded to be 0.0 for crack</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;               ystart = 0.01<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;               islp = 0</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;               <span class="keywordflow">do</span> <span class="keywordflow">while</span> (xstart &lt; xmax) </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                  xend = xstart + (ymax-ystart)/tan(slip_angle(i)) </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                  <span class="keywordflow">if</span> (xend &gt; xmax) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                     xend = xmax </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                     yend = ystart + (xend-xstart)*tan(slip_angle(i))</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                     yend = ymax</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                  islp = islp + 1</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 1</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = ystart </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                  yendslp(islp) = yend</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                  xstart = xstart + dxslip</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">!                  xend = xstart + (ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;               print *, <span class="stringliteral">&#39;End of first slip =&#39;</span>, islp</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (i == 2) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;               xstart = xmin + dxslip</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!     ystart is hard coded to be 0.0 for crack</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;               ystart = 0.01<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!               xend =xstart+(ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">!               print *, xstart, xend</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;               <span class="comment">!islp = 0</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;               j = 0</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;               <span class="keywordflow">do</span> <span class="keywordflow">while</span> (xstart &lt; xmax) </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  j = j + 1</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                  xend = xstart + (ymax-ystart)/tan(slip_angle(i))</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                  <span class="keywordflow">if</span> (xend &lt; xmin) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                     xend = xmin</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                     yend = ystart + (xend-xstart)*tan(slip_angle(i))</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                     yend = ymax</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                  islp = islp + 1</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 2</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = ystart</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  yendslp(islp) = yend</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  xstart = xstart + dxslip</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!                  xend = xstart + (ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                  <span class="comment">!print *, islp, xslp(islp), xendslp(islp)</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;               print *, <span class="stringliteral">&#39;End of second slip =&#39;</span>, islp</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            xstart = xmin</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            xend = xmax</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            ystart = dyslip</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;c$$$            nqslp = islp</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            j = 0</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span>(ystart &lt; ymax) </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               islp = islp + 1</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;               j = j+1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 3</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = ystart</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;               yendslp(islp) = ystart</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;               ystart = ystart + dyslip</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;             print *, <span class="stringliteral">&#39;End of third slip =&#39;</span>, islp,j</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;             <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      print *, <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(1), <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(2), <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(3)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      nshift = <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(1)+<a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(2)+<a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(3)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">!     Now mirror slip planes</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         <span class="keywordflow">if</span> (i .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">if</span> (i == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               xstart = xmin + dxslip</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">!     ystart is hard coded to be 0.0 for crack</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;               ystart = -0.01<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;               <span class="keywordflow">do</span> <span class="keywordflow">while</span> (xstart &lt; xmax) </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                  xend = xstart + (ymin-ystart)/tan(slip_angle(i)) </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                  <span class="keywordflow">if</span> (xend &lt; xmin) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                     xend = xmin </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                     yend = ystart + (xend-xstart)*tan(slip_angle(i))</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                     yend = ymin</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                  islp = islp + 1</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 1</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = ystart </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                  yendslp(islp) = yend</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                  xstart = xstart + dxslip</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!                  xend = xstart + (ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;               print *, <span class="stringliteral">&#39;End of first slip =&#39;</span>, islp</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">if</span> (i == 2) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;               xstart = xmin + dxslip</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">!     ystart is hard coded to be 0.0 for crack</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               ystart = -0.01<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">!               xend =xstart+(ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">!               print *, xstart, xend</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;               <span class="comment">!islp = 0</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;               j = 0</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;               <span class="keywordflow">do</span> <span class="keywordflow">while</span> (xstart &lt; xmax) </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                  j = j + 1</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                  xend = xstart + (ymin-ystart)/tan(slip_angle(i))</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                  <span class="keywordflow">if</span> (xend &gt; xmax) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                     xend = xmax</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                     yend = ystart - (xstart-xend)*tan(slip_angle(i))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                     yend = ymin</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                  islp = islp + 1</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 2</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = ystart</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                  yendslp(islp) = yend</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                  xstart = xstart + dxslip</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">!                  xend = xstart + (ymax-ystart)/tan(slip_angle(i))</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                  <span class="comment">!print *, islp, xslp(islp), xendslp(islp)</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;               print *, <span class="stringliteral">&#39;End of second slip =&#39;</span>, islp</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            xstart = xmin</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            xend = xmax</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            ystart = dyslip</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;c$$$            nqslp = islp</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            j = 0</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span>(ystart &lt; ymax) </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;               islp = islp + 1</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;               j = j+1</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) = 3</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) = xstart</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp) = xend</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) = -ystart</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;               yendslp(islp) = -ystart</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;               ystart = ystart + dyslip</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;c$$$                  <span class="keywordflow">if</span> (mod(islp,25) .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;c$$$                     <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,4(1X,E15.7))&#39;</span>)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;c$$$     $                    islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp), <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp),</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;c$$$     $                    yendslp(islp)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;             print *, <span class="stringliteral">&#39;End of third slip =&#39;</span>, islp,j</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;             <a class="code" href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">inslip</a>(i) = islp</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a> = islp</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ad8ebdc112d561b2fc072a77bc9528ced">n_active_slip</a> = <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>/<a class="code" href="namespacemod__dd__slip.html#aa9b6bdf8069606d789cdd50a14fc71fb">slipspc</a></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      print *, <span class="stringliteral">&#39;No. of active slip systems = &#39;</span>,<a class="code" href="namespacemod__dd__slip.html#ad8ebdc112d561b2fc072a77bc9528ced">n_active_slip</a>, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;c$$$     calculate shifting parameters <a class="code" href="namespacemod__dd__slip.html#a004daac9f301139eee9242c420861fc5">for</a> slip planes</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;c$$$      shifting is used to control <a class="code" href="namespacemod__dd__slip.html#af7244818b02606f77299af285861cbd4">dislocations</a> leaving upper and</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;c$$$     $     entering lowere</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a> = 0</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         xi = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         <span class="keywordflow">if</span> (li &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">do</span> jslp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;               xj = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(jslp)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;               lj = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(jslp)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;               <span class="keywordflow">if</span> (lj &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                  <span class="keywordflow">if</span> (islp .ne. jslp) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                     <span class="keywordflow">if</span> (li == lj) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <span class="keywordflow">if</span> (xi == xj) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                           <a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a>(islp) = jslp</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keywordflow">            enddo</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;c$$$         print *, <span class="stringliteral">&#39;nshift&#39;</span>, islp, <a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a>(islp)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">!stop</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aebab0eb78f3f219f189a6dadd9f58cd5">gen_slip_planes</a></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a6ca1bfbcf018ab04c20fc2cb9028a042">remove_disl_global</a>(idisl_slip)</div>
<div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a6ca1bfbcf018ab04c20fc2cb9028a042">  460</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      include <span class="stringliteral">&#39;disl_parameters.par&#39;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp, idisl_slip</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      k = 0</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;               k = k + 1</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;               <span class="keywordflow">if</span> (k == idisl_slip) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">rmdisl_g</a>(i,islp)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">!                  call rmdisl_continuum(i,islp)</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">!                  call put_in_bucket(i,islp)</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">! Dislocation is removed from the continuum on slip plane level and </span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">! global level.. </span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a6ca1bfbcf018ab04c20fc2cb9028a042">remove_disl_global</a></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a17d514ce0e161af30b78833d2b77d6cd">put_in_bucket</a>(i,islp)</div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a17d514ce0e161af30b78833d2b77d6cd">  482</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp,jslp</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">double precision</span> :: hold</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      bout(1,islp) = bout(1,islp) + <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) = sdis_out(1,islp)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sdis_out(1,islp) *</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;     $     cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sdis_out(1,islp) *</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     $     <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      elem_dis(i,islp) = 0</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      print *, <span class="stringliteral">&#39;Dislocation&#39;</span> , i, <span class="stringliteral">&#39;on&#39;</span>, islp, <span class="stringliteral">&#39;put in bucket&#39;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a17d514ce0e161af30b78833d2b77d6cd">put_in_bucket</a></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">calc_bout</a></div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">  497</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp, bplus, bminus</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         bplus = 0</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         bminus = 0</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                  bplus = bplus + 1</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  bminus = bminus + 1</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            bout(1,islp) = -(bplus-bminus)*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            bout(2,islp) = 0</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         print *, <span class="stringliteral">&#39;Bucket total =&#39;</span>, bout(1,islp)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">calc_bout</a></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">rmdisl</a>(i,islp, ar1, ar2, ar3, ar4)</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">  519</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp,jslp</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordtype">double precision</span> :: hold</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordtype">double precision</span> :: ar1(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), ar2(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;     $     ar3(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), ar4(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      hold = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">do</span> j=i+1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(j-1,islp) =<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(j,islp)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j-1,islp)=<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j,islp)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,j-1,islp) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,j,islp)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         elem_dis(j-1,islp) = elem_dis(j,islp)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;         vprev(j-1,islp) = vprev(j,islp)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(j-1,islp) = <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(j,islp)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         ar1(j-1,islp) = ar1(j,islp)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         ar2(j-1,islp) = ar2(j,islp)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;         ar3(j-1,islp) = ar3(j,islp)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         ar4(j-1,islp) = ar4(j,islp)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      print *, <span class="stringliteral">&#39;Removing dislocation&#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) = <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)-1</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> -1</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">rmdisl</a></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">rmdisl_g</a>(i,islp)</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">  544</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp,jslp</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordtype">double precision</span> :: hold, roldq(3)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordtype">double precision</span> :: v(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), c(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;     $     tau(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), sold(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), bb</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      print *, <span class="stringliteral">&#39;Removing dislocation&#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      roldq(1:3) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i,islp)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      hold = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">do</span> j=i+1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(j-1,islp) =<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(j,islp)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j-1,islp)=<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j,islp)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,j-1,islp) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,j,islp)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;         elem_dis(j-1,islp) = elem_dis(j,islp)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         vprev(j-1,islp) = vprev(j,islp)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(j-1,islp) = <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(j,islp)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) = <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)-1</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> -1</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">rmdisl_g</a></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a2b481a5fc03033c09e15385fde823efd">assign_new_global</a>(xtip_move)</div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a2b481a5fc03033c09e15385fde823efd">  567</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      include <span class="stringliteral">&#39;disl_parameters.par&#39;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordtype">integer</span> :: i,j,islp,ii,k,li, btot,fe_locate, elem_old</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordtype">double precision</span> :: pi, xend, yend,cphi,sphi</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordtype">double precision</span> :: xstart, ystart, bb, bsign, ss, ss1, sd</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordtype">double precision</span> :: xtip_move</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordtype">integer</span> :: ndisl1</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      pi = 2.d0*asin(1.0d0)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = 0</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            rnuc(1,i,islp) = rnuc(1,i,islp) - xtip_move</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            elem_old = <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(i,islp)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(i,islp) = fe_locate(rnuc(:,i,islp), elem_old)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> + <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">calc_bout</a></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">! --- Set all quantities to zero</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;         cphi = cosphi(li)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            sd = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> (li &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;               <span class="keywordflow">if</span> (yendslp(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sd*cphi</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sd*sphi</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                  <span class="keywordflow">if</span> (li == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) - sd*cphi</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sd*cphi</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp) = -(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sd*sphi)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sd*cphi</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sd*sphi   </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1,i,islp) - xtip_move</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(2:3,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(2:3,i,islp)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            elem_old = elem_dis(i,islp)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            elem_dis(i,islp) = fe_locate(<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(:,i,islp), elem_old)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a2b481a5fc03033c09e15385fde823efd">assign_new_global</a></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">  627</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      include <span class="stringliteral">&#39;disl_parameters.par&#39;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordtype">integer</span> :: i,j,islp,ii,k,li, btot,fe_locate</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordtype">double precision</span> :: pi, xend, yend,cphi,sphi</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordtype">double precision</span> :: xstart, ystart, bb, bsign, ss, ss1</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordtype">integer</span> :: ndisl1</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      pi = 2.d0*asin(1.0d0)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = 0</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> + <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">calc_bout</a></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">! --- Set all quantities to zero</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      burgers = 0.0d0</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      burg_length = <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      theta_e = 0.0d0</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      theta_s = 0.0d0</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      r_disl = 0.0d0</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      r_old = 0.0d0 </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      pk_force = 0.0d0</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      pk_f = 0.0d0</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      elem_disl = 0</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      ndisl = 0</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      ndisl_dd = 0</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      ndisl1 = 0</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      k = 0</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;         cphi = cosphi(li)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;         xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;         yend = yendslp(islp)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;         ss = sdis_out1(1,islp) + <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;c$$$         <span class="keywordflow">if</span> (sdis_out(1,islp) .ne. sdis_out(1,islp)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;c$$$            ss1 = sdis_out1(1,islp) -6.d0*<a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;c$$$         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            ss1 =sdis_out(1,islp)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;c$$$<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         <span class="keywordflow">if</span> (abs(bout(1,islp)) &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            bb = <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            btot = nint(abs(bout(1,islp))/<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">if</span> (bout(1,islp) &lt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;               bb = -<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">!            print *, &#39;Bucket dislocations&#39;</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">do</span> i = 1, btot</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;               k = k + 1</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;               burg_length(k) = bb</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;               burgers(1,k) = bb*cphi</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;               burgers(2,k) = bb*sphi</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;               burgers(3,k) = 0.0d0</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;               <span class="keywordflow">if</span> (bb &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                  theta_e(k) = -pi</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                  theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;c$$$               <span class="keywordflow">if</span> (bb &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;c$$$                  <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;c$$$                     theta_e(k) = pi</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;c$$$                     theta_e(k) = -pi</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;c$$$               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;c$$$                  <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;c$$$                     theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;c$$$                     theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;c$$$<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;c     try making the position <a class="code" href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">of</a> the bucket dislocation to be at the</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;c     <a class="code" href="contri_8f.html#ac2443146a37d7fe86e9188711240347b">edge</a> <a class="code" href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">of</a> the atomistic region </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;c     this means replacing the <a class="code" href="feaplib_8f.html#ac744a184cbe7429abdc78291e16436e9">next</a> 3 lines here with sdis_out1</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;               r_disl(1,k) = xstart + (ss1)*cphi</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;               r_disl(2,k) = ystart + (ss1)*sphi</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;               r_disl(3,k) = 0.0d0</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;               r_old(1:3,k) = r_disl(1:3,k)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;               elem_disl(k) = 0</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;               disl_index(k) = 2</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;               disl_range(1,k) = <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a> + <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;               disl_range(2,k) = atom_ymax + <a class="code" href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">disl_range_tol</a></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;               print *, <span class="stringliteral">&#39;Buck&#39;</span>, i, islp, r_disl(1,k), r_disl(2,k)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;               k = k + 1</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;               ndisl1 = ndisl1 + 1</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;               ndisl_dd(k) = ndisl1</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;               burg_length(k) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;               burgers(1,k) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;               burgers(2,k) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;               burgers(3,k) = 0.0d0</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;               bb = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;               <span class="comment">!print *, &#39;qqq&#39;,k, ndisl1, ndisl_dd(k)</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;c     <span class="keywordflow">Do</span> not switch cut plane directions in switching from bottom to top</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;c     this is only to ensure that the currect <a class="code" href="disl__field_8f.html#ab6f89364197ee3e5c1b2969f8f3d8f5f">disl_u</a><span class="keyword"> subroutine </span>is</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;c     satisfied </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;c     also since there is always going to be a bucket dislocation </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;c     the direction <a class="code" href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">of</a> the cut plane is not relevant(???)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;               <span class="keywordflow">if</span> (bb &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  theta_e(k) = -pi</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;c$$$               <span class="keywordflow">if</span> (bb &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;c$$$                  <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;c$$$                     theta_e(k) = -pi</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;c$$$                     theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;c$$$               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;c$$$                  <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;c$$$                     theta_e(k) = 0.0d0</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;c$$$                     theta_e(k) = -pi</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;c$$$<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;               r_disl(1:3,k) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i,islp)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;               r_old(1:3,k) = <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1:3,i,islp)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;               elem_disl(k) = elem_dis(i,islp)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;               disl_index(k) = 2</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;               disl_range(1,k) = xstart + abs(ss*cphi)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;               disl_range(2,k) = abs(ystart) + abs(ss*sphi)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      ndisl = k</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">!      ndisl = k-1</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      print *, <span class="stringliteral">&#39;Global Disloc total = &#39;</span>, ndisl</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      print *, <span class="stringliteral">&#39;Gloabal Dislocations are&#39;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">do</span> i = 1,ndisl</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,6(1X,E15.8),1X,2I7,3(1X,E15.8))&#39;</span>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;     $        i, r_old(1:2,i), r_disl(1:2,i), disl_range(1:2,i),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;     $        elem_disl(i), ndisl_dd(i), burgers(1:2,i), theta_e(i)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9b9cf2223906f53f6bae978b3f70e32b">move_disloc</a>(rhs)</div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a9b9cf2223906f53f6bae978b3f70e32b">  774</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,ii,islp, li, elem_old, fe_locate</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordtype">double precision</span> :: si,bi,sini,cosi, tauij,taug,</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     $     dsi,sout(3), fg, fgg,snew, roldq(3), phi2, rhs(*)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordtype">double precision</span> :: sinit, sfinal, tauii, tau, xi, yi</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordtype">double precision</span> :: dist, eps,dlim, flim, dstar, s1, xstart,ystart</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;c$$$      <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: tau1(:,:), v1(:,:), c(:,:),</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;c$$$     $     sold(:,:)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keywordtype">double precision</span> :: tau1(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), v1(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>),</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;     $     c(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), sold(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">double precision</span> :: cnew, ddt, dt, dx, dv, ddtm, vi, vpp,vj, xqone</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordtype">double precision</span> :: tlce, rpile, ds, temp_s(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordtype">logical</span> :: move_bottom</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      include <span class="stringliteral">&#39;disl_parameters.par&#39;</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">! Include obstacle parameters here</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__dd__slip_1_1dd.html">dd</a>) :: dd1(<a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a>)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      dt = <a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      ddt = dt</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      eps = 1.0<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      flim = eps</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      dlim = flim/5.0d0</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      dstar = 2.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      rpile = dstar</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;c$$$      <span class="keyword">allocate</span>(tau1(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), v1(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), c(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;c$$$      <span class="keyword">allocate</span>(sold(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      tau1 = 0.0d0</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      v1 = 0.0d0</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      c = 0.0d0</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      sold = 0.0d0</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f">assign_disloc_only</a>(dd1)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4">calcforce</a>(dd1,1,<a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a>)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      k = 1</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;         cosi = cosphi(li)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         sini = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;         sinit = sdis_out1(1,islp)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;         sfinal = sdis_out(2,islp)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;               phi2=2.d0*<a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;               bi = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;               si = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;               sold(i,islp) = si</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;               elem_old = elem_dis(i,islp)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;               roldq(1:3) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i,islp)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;               fg = <span class="keywordtype">real</span>(dd1(k)%forced)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;               fgg = <span class="keywordtype">real</span>(dd1(k)%forcedg)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;               <span class="keywordflow">if</span> (elem_dis(i,islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                  <span class="keyword">call </span><a class="code" href="fem__alan_8f.html#a7b711d38a8c3b46a70da0f46aa130b33">fe_stress</a>(elem_dis(i,islp), rhs,</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;     $                 sout)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;               phi2=2.d0*<a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;               taug = 0.5d0*(sout(2)-sout(1))*sin(phi2)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     $              + sout(3)*cos(phi2)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               tauij = fg/bi</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;               tauii = tauij + taug</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;               vi = tauii*bi/<a class="code" href="namespacemod__dd__slip.html#ad0c0e918c73157f9ed34c0dd8bb9a4c1">bdrag</a></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;               vpp = vi/(1-fgg*dt/<a class="code" href="namespacemod__dd__slip.html#ad0c0e918c73157f9ed34c0dd8bb9a4c1">bdrag</a>)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;               <span class="keywordflow">if</span> (vi/vpp &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                  vi = vpp</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                  <span class="keywordflow">if</span> (abs(vi) &gt; abs(vpp)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                     vi = vi + vpp</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;               <span class="keywordflow">if</span> (abs(vi) &gt; <a class="code" href="namespacemod__dd__slip.html#a219c9587e77839191feb3723d12fb263">vcutoff</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                  vi = sign(<a class="code" href="namespacemod__dd__slip.html#a219c9587e77839191feb3723d12fb263">vcutoff</a>,vi)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;               <span class="keywordflow">if</span> (yendslp(islp) &lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                  vi = -vi</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;               tau1(i,islp) = tauii</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;               dsi = vi*dt</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;               snew = si + dsi</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) == 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;               <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(A5,1X,2I7,1X,5(1X,E15.8))&#39;</span>) <span class="stringliteral">&#39;Disl.&#39;</span>,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;     $              i, islp, vi, si, dsi, snew, dt</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">! Check against obstacles</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                  snew = si</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                  <span class="keywordflow">do</span> j =1,<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                     dist = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(j,islp)-si</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                     <span class="keywordflow">if</span>(abs(dist) .ge. eps) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <span class="keywordflow">if</span> (dsi/dist &gt; 1.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                           snew = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(j,islp)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                           <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) = -j</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                           print *, <span class="stringliteral">&#39;Disloc &#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp,</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;     $                          <span class="stringliteral">&#39;about to be pinned at obstacle&#39;</span>, j</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordflow">                  end do</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;               v1(i,islp) = (snew-si)/dt</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;               k = k + 1</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">!     Determine underrelaxation parameters --- not really necessary but</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">!     still there </span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">!      call undrex(v1,c)</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      print *, <span class="stringliteral">&#39;Underrelaxation factors&#39;</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      c = 1.0d0</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="comment">!v1 = vi</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; 128        <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="keywordflow">do</span> i = 2, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;               print *, <span class="stringliteral">&#39;undrex&#39;</span>, i,islp, c(i,islp), v1(i,islp)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;               dx = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)-<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i-1,islp)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;               <span class="keywordflow">if</span> (dx &lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                  <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;Wrong order of dislocations&#39;</span>, dx, i,islp</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                  stop</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;               vi = c(i,islp)*v1(i,islp)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;               vj = c(i-1,islp)*v1(i-1,islp)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;               dv = vi - vj</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;               <span class="keywordflow">if</span> (dv .ne. 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                  ddtm = -dx/dv</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                  <span class="keywordflow">if</span> (ddtm &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i-1,islp) &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                        xqone = 1.0d0 - 1.0<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-10</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                        <span class="keywordflow">if</span> (dx/rpile &lt; xqone) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                           print *, <span class="stringliteral">&#39;too short in pileup&#39;</span>, dx/rpile, i</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;     $                          ,islp</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        dx = dx - rpile</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        <span class="keywordflow">if</span> (dx &lt; 0.0d0 .and. tlce(abs(dx)/eps) &lt; 1.0d0)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;     $                       <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                           dx = 0.0d0</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        ddtm = -dx/dv</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                     ddtm = abs(ddtm)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                     <span class="keywordflow">if</span> (tlce(ddtm/ddt) &lt;= 1.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        ddt = ddt/2.0d0</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        cnew = 0.8d0*ddtm/dt</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        c(i,islp)=c(i,islp)*cnew</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        c(i-1,islp) = c(i-1,islp)*cnew</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        <span class="keywordflow">goto</span> 128</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;         cosi = cosphi(li)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         sini = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;         <span class="keywordflow">if</span> (sdis_out1(1,islp) .ne. sdis_out(1,islp)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            sinit = sdis_out1(1,islp)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            sinit = sdis_out(1,islp)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         sfinal = sdis_out(2,islp)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            print *, <span class="stringliteral">&#39;Sinit = &#39;</span>, sinit, <span class="stringliteral">&#39; Sfinal = &#39;</span>,sfinal </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;               s1 = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) + c(i,islp)*v1(i,islp)*ddt</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;               bi = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;               dsi = c(i,islp)*v1(i,islp)*ddt</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)+dsi</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;               print *, <span class="stringliteral">&#39;Disloc&#39;</span>, i, <span class="stringliteral">&#39;Old = &#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp),</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;     $         <span class="stringliteral">&#39; new = &#39;</span>, s1</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(3,i,islp) = 0.0d0        </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;               snew = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;               temp_s(i,islp) = snew</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">!     Pin disloc at the  interface</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">!               if (elem_dis(i,islp) &gt; 0) then</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                     <span class="keywordflow">if</span> (snew &lt; sinit .or. snew &gt; sfinal) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        <span class="keywordflow">if</span> (snew &lt; sinit) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                           print *,</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;     $                          <span class="stringliteral">&#39;Dislocation close to interface </span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     $                          or atomisitcs&#39;</span>,snew</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                           snew = sinit</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                           snew = sfinal</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">!               endif</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) = snew</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;               <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1:3,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i,islp)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;               <span class="keywordflow">if</span> (li &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                  <span class="keywordflow">if</span> (yendslp(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + snew*cosi</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp)=<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + snew*sini</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                     <span class="keywordflow">if</span> (li == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)-snew</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;     $                    *cosi</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                     <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)+abs(snew</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;     $                    *cosi)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp)=-(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)+snew</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;     $                    *sini)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + snew*cosi</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp) = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + snew*sini</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               elem_dis(i,islp) = fe_locate(<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(:,i,islp),elem_old)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;               print *, <span class="stringliteral">&#39;Dislocation&#39;</span>, i, <span class="stringliteral">&#39;on&#39;</span>, islp, <span class="stringliteral">&#39;with&#39;</span>,</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     $              bi, <span class="stringliteral">&#39;moved from&#39;</span>,</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;     $              <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1,i,islp),<a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(2,i,islp),<span class="stringliteral">&#39;to&#39;</span>,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;     $              <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp),<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;     $              , si, dsi, elem_dis(i,islp)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;c$$$               print *, <span class="stringliteral">&#39;pk-force =&#39;</span>, i, islp, tauii*bi,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;c$$$     $              <span class="keywordtype">real</span>(dd1(k)%forced)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;c$$$  print *, <span class="stringliteral">&#39;Dislocation &#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp, <span class="stringliteral">&#39;moved from&#39;</span>,</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;c$$$  $                elem_old, <span class="stringliteral">&#39; to &#39;</span>, elem_dis(i,islp)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;c$$$               <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1:3,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(i:3,i,islp)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;               k = k + 1</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordflow">do</span> islp =1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            i = 2</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (i &lt;= <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)) </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i-1,islp)&lt;0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                  <span class="keywordflow">if</span> (tlce(<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i-1,islp)/<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)) &gt; 1.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                     si = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                     <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;Wrong order&#39;</span>, i,islp,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     $                    <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp),<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i-1,islp)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                     ds = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) - <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i-1,islp)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                     <span class="keywordflow">if</span> (ds &lt;= <a class="code" href="namespacemod__dd__slip.html#a83d7aa286ea628f8388281a435d91ce6">xle</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                        <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">rmdisl</a>(i,islp,v1, tau1,c,sold)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                        <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">rmdisl</a>(i-1,islp,v1,tau1,c,sold)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                        i = i -1</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;               i = i + 1</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         <span class="keywordflow">do</span> i=1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="keywordflow">do</span> j = 1, <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp)+j .eq. 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                  dist = dabs(<a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(j,islp)-<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp))</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                  <span class="keywordflow">if</span> (dist .lt. eps) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) = j</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                     <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;Dislocation &#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;     $                    <span class="stringliteral">&#39; pinned at obstacle &#39;</span>, j</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) = 0</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aeba8fb187f64622088528a9e46949293">rlsdis</a>(tau1)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">!     --- Pass dislocations from top to bottom or simply put in bucket</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">!     if xstart &lt; atom_xmin + tol</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      move_bottom = .true.</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;         cosi = cosphi(li)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;         sini = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;         <span class="keywordflow">if</span> (sdis_out1(1,islp) .ne. sdis_out(1,islp)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            move_bottom = .false. </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            sinit = sdis_out(1,islp)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            sinit = sdis_out(1,islp)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            move_bottom = .true.</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         sfinal = sdis_out(2,islp)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         i = 1</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;         k = 1</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         <span class="keywordflow">do</span> <span class="keywordflow">while</span>(i&lt;<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)) </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;               <span class="keywordflow">if</span> (temp_s(i,islp) &lt;  sinit) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                  <span class="keywordflow">if</span> (move_bottom) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                     l = islp + <a class="code" href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">nshift_slip</a>(islp)</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                     print *, <span class="stringliteral">&#39;Removing from top and putting in bottom&#39;</span>,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;     $                    temp_s(i,islp), sinit</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) &lt; <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                        <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">rmdisl_g</a>(i,islp)                        </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                        <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a>(temp_s(i,islp), sinit, l, <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     $                       ,islp),1)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                        <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">rmdisl_g</a>(i,islp)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                     i = i + 1</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                  i = i + 1</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;               k = k + 1</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;               vprev(i,islp) = v1(i,islp)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;c$$$      <span class="keyword">deallocate</span>(tau1,v1,c)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;c$$$      <span class="keyword">deallocate</span>(sold)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9b9cf2223906f53f6bae978b3f70e32b">move_disloc</a></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aa4787e27bc5ee443900f5339fbc9cf61">nucleate_disl</a>(rhs)</div>
<div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aa4787e27bc5ee443900f5339fbc9cf61"> 1111</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordtype">integer</span> islp,jslp,i,j,k,l</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keywordtype">double precision</span> s, xi, xLh, bsign, sout(3), rhs(*), phi2,tau</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordtype">double precision</span> ev_convert, fact, tau_source, tauij_s, taug_s</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="keywordtype">double precision</span> qsign</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__dd__slip_1_1dd.html">dd</a>) :: dd1(<a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a>)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordtype">logical</span> create</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      bsign = 1.0d0</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      create = .false.</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            ev_convert = 1.602176462</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            fact = 1.d0/ev_convert/1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f">assign_disloc_only</a>(dd1)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a2c770b7a4f80a17980a3b3ad0c046485">assign_source_only</a>(dd1)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4">calcforce</a>(dd1,<a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a>+1,<a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a>)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      k = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> + 1</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(i,islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    <span class="keyword">call </span><a class="code" href="fem__alan_8f.html#a7b711d38a8c3b46a70da0f46aa130b33">fe_stress</a>(<a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(i,islp), rhs,</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;     $                   sout)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">                 endif</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                 phi2=2.d0*<a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                 taug_s = 0.5d0*(sout(2)-sout(1))*sin(phi2)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;     $                + sout(3)*cos(phi2)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                 tauij_s = <span class="keywordtype">real</span>(dd1(k)%forced)/blen</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                 tau_source = taug_s + tauij_s</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;c$$$                 taui(i,islp) = taui(i,islp) + <span class="keywordtype">real</span>(dd1(k)%forced)/blen</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;c$$$     $                + tau </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                 sout = sout*fact</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;               <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(3I7,1X,3(1X,E15.7))&#39;</span>) i,islp,k,tau_source,</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;     $                <span class="keywordtype">real</span>(dd1(k)%forced)/blen*fact, taui(i,islp)*fact</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;               <span class="keywordflow">if</span> (tnlaps(i,islp) &lt; 0.5*<a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                  tnlaps(i,islp) = 0.0d0</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;               qsign = 1.0d0</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;               <span class="keywordflow">if</span> (tau_source*taui(i,islp) &lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                  qsign = -1.0d0</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;               <span class="keywordflow">if</span> (abs(tau_source) &gt;= <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(i,islp)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                  tnlaps(i,islp) = tnlaps(i,islp) + qsign*<a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                  print *, <span class="stringliteral">&#39;Source &#39;</span>, i, <span class="stringliteral">&#39; on &#39;</span>, islp, <span class="stringliteral">&#39;tnlaps&#39;</span>,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;     $                 tnlaps(i,islp)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                  <span class="keywordflow">if</span> (tnlaps(i,islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                     tnlaps(i,islp) = tnlaps(i,islp) - <a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;               <span class="keywordflow">if</span> (tnlaps(i,islp) &lt; 0.5*<a class="code" href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">tincr</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                  tnlaps(i,islp) = 0.0d0</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;               k = k + 1</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;               taui(i,islp) = tau_source</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;               <span class="keywordflow">if</span> (tnlaps(i,islp) &gt; <a class="code" href="namespacemod__dd__slip.html#a343d0dd2938aa21a57d02d2d9205434b">tnuc</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                  xlh = <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(i,islp)/2.d0</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                  xi = snuc(i,islp)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                  <span class="keywordflow">if</span> (taui(i,islp) &lt; 0.0d0) bsign = -1.0d0</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                  <span class="keywordflow">if</span> (yendslp(islp) &lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                     bsign = -bsign</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                  <span class="comment">!print *, &#39;Generating dislocations on slip plane&#39;,islp</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a>(xi-xlh, xi,islp,-blen*bsign,i)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                  <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a>(xi+xlh, xi,islp,blen*bsign,i)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                  create = .true.</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                  tnlaps(i,islp) = 0.0d0</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="comment">!if (create) stop</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aa4787e27bc5ee443900f5339fbc9cf61">nucleate_disl</a></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9f46d3bb0ad2b69b394ca5d224221991">nucleate_atomistic_disl</a> (islp, s_disl, th_e, th_s, bv)</div>
<div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a9f46d3bb0ad2b69b394ca5d224221991"> 1196</a></span>&#160;c     nucleate a dislocation passed in from atomistics</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;c     automatically handles <a class="code" href="namespacemod__dd__slip.html#af7244818b02606f77299af285861cbd4">dislocations</a> to be put into the bucket </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;c     islp -- slip plane to nucleate dislocation</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;c     s_disl --- position on slip plane to nucleate dislocation</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;c     bv -- burgers vector <a class="code" href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">of</a> dislocation</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;c     th_e, th_s --- angles <a class="code" href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">of</a> dislocation to be inserted</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordtype">integer</span> :: islp, i, j, k, l, li</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordtype">double precision</span> :: s_disl, th_e, th_s, bv(3)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keywordtype">double precision</span> :: bsign, bmag</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">parameter</span> :: dtol=1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;c     angle is already checked when finding slip plane</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;c     now we only re-check with different criteria</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;c     assign correct sign <a class="code" href="namespacemod__dd__slip.html#a004daac9f301139eee9242c420861fc5">for</a> dislocation </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">if</span> (abs(bv(1)-<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>*cosphi(li))&lt; dtol .and.</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;     $     abs(bv(2) - <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li))&lt; dtol) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         bsign = 1.0d0</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;         bsign = -1.0d0</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a>(s_disl, s_disl-6.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>, islp, bsign*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">assign_disloc_global</a> </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9f46d3bb0ad2b69b394ca5d224221991">nucleate_atomistic_disl</a></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a> (si,slim,islp,bi,nuc_num)</div>
<div class="line"><a name="l01227"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6"> 1227</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordtype">integer</span> i,j,k,l,m,n,islp, fe_locate, el_source</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span> :: nuc_num</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordtype">double precision</span> si,slim,bi,shold,xcl</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keywordtype">double precision</span> xint, dstr,dstar,sold, stest</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      dstar = 2*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      n = <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      shold = si</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      xcl = si-slim</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      xint = 3.d0*2.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      dstr = 2.d0*dstar</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a53c50dfaacd2acedac0f46fc0070f557">rpile</a> = 2.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      i = 0</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(nuc_num)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         el_source = <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(nuc_num,islp)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="comment">! --- Make sure dislocations are in order</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;ctodo <span class="comment">! -- Make sure dislocations are atleast 6*b away from each other </span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      i = 1</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (shold &gt; <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) .and. i &lt;= <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp))</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         i = i + 1</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      k = i</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="comment">!print *, &#39;Insertion location&#39;, k</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) = <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) + 1</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> + 1</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a> = <a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a> + 1</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">do</span> i=<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp),k+1,-1</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp) = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i-1,islp)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)=<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i-1,islp)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,i-1,islp)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         elem_dis(i,islp)=elem_dis(i-1,islp)</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1:3,i,islp) = <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(1:3,i-1,islp)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         vprev(i,islp)=vprev(i-1,islp)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) = <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i-1,islp)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(k,islp) = shold</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(k,islp) = bi</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(k,islp) = 0</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="keywordflow">if</span> (yendslp(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,k,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)+si*cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,k,islp)=<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)+si*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,k,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)-si*cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,k,islp)=<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)+abs(si*cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)))</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,k,islp)=-(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)+si*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)))</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(3,k,islp) = 0.0d0</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      elem_dis(k,islp) = fe_locate(<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1:3,k,islp),1)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keyword">write</span>(*, fmt=<span class="stringliteral">&#39;(A30,1X,I7,3(1X,E15.7),1X, A15,I7,1X,E15.8)&#39;</span>)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;     $     <span class="stringliteral">&#39;Dislocation Generated on&#39;</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;     $     , islp, <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(k,islp),<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,k,islp), <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,k,islp),</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;     $     <span class="stringliteral">&#39;in element&#39;</span>, elem_dis(k,islp), <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(k,islp)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">crdisl</a></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aeffe22b6b2164f2f76d4d956460516a8">gen_slip_ends</a></div>
<div class="line"><a name="l01287"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aeffe22b6b2164f2f76d4d956460516a8"> 1287</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,islp, li</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordtype">double precision</span> :: xstart, xend, ystart, yend,xend1,yend1</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordtype">double precision</span> :: sphi, cphi, tphi</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordtype">double precision</span> :: dlmax, dlmax1</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordtype">double precision</span> :: xmax1, xmin1, ymin1, ymax1</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;c     initialize the dislocation end variables </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      sdis_out = 0.0d0</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      sdis_out1 = 0.0d0</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;c$$$      xmax1 = <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a> + <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;c$$$      xmin1 = (<a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a> - <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a>)/2.0d0</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;c$$$      ymax1 = atom_ymax + <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;c$$$      ymin1 = atom_ymin - <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      xmax1 = <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a> </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      xmin1 = <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      ymax1 = atom_ymax</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      ymin1 = atom_ymin</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         cphi = cosphi(li)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         tphi = sphi/cphi</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         yend = yendslp(islp)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         <span class="keywordflow">if</span> (li .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            dlmax = abs(yend-ystart)/sphi</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            dlmax = xend-xstart</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;         sdis_out(1,islp) = 0.0d0 + 1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3 </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         sdis_out(2,islp) = dlmax - 1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-3</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;         <span class="keywordflow">if</span> (xstart &gt; xmin1 .and. xstart &lt; xmax1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">if</span> (li .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;               <span class="keywordflow">if</span> (yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                  xend1 = xstart + (ymax1-ystart)/tphi</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                  yend1 = atom_ymax</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                  <span class="keywordflow">if</span> (xend1 &gt; xmax1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                     xend1 = xmax1</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                     yend1 = abs(xend1-xstart)*abs(tphi)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                  <span class="keywordflow">if</span> (xend1 &lt; xmin1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                     xend1 = xmin1</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                     yend1 = abs(xend1-xmin1)*abs(tphi)</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;               dlmax1 = sqrt((xstart-xend1)**2 + (ystart-yend1)**2) +</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;     $              <a class="code" href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">sdis_out_tol</a></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;               sdis_out1(1,islp) = dlmax1 - 2.0d0</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;               <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(2I7,5(1X,E15.8))&#39;</span>),</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;     $              li, islp, <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp), xend1, yend1,sdis_out1(1,islp)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aeffe22b6b2164f2f76d4d956460516a8">gen_slip_ends</a></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aff0b59f4ed0b06d8190a1f32c838dc1b">gen_sources</a></div>
<div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aff0b59f4ed0b06d8190a1f32c838dc1b"> 1350</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keywordtype">double precision</span> :: xe, xnu, xlambda, xmu, pi</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="keywordtype">double precision</span> :: cc(6,6)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordtype">integer</span> :: i_elas</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keyword">common</span> /elastic/ xe, xnu, xlambda, xmu, cc, i_elas</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l, islp, iseed1, iseed2, fe_locate</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordtype">logical</span> :: accept</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordtype">double precision</span> :: ev_convert, e, mu, nu, lambda, lnuc</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span> :: source_dist(:)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="comment">! --- Obtain Properties of the material from main input</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="comment">!---- Calculate total no. of sources based on density and area</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="comment">! --- Generate an array of source strengths</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="comment">! --- Assign each source the strength and compute L_nuc</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="comment">! --- Place the source according to L_nuc</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordtype">double precision</span> :: dlmax, dlengthslp, xstart, xend, ystart,yend</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordtype">double precision</span> :: qsrc, rand(2), rand1(2), sphi, cphi</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordtype">integer</span> :: nsrc, ii, li</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keywordtype">double precision</span> :: atomistic_exclusion, lnuc_exclusion, factor,</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;     $     tol</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">!     currently hard coded -- need to include in input file      </span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      pi = 3.1415926535898</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      ev_convert = 1.602176462</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">source_den</a> = 66 <span class="comment">! per /um^2</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">source_den</a> = 66.0<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-8  <span class="comment">! per Angstrom^2</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a> = int(process_area*<a class="code" href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">source_den</a>) + 10</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      qsrc = <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a>*1.d0/(<a class="code" href="namespacemod__dd__slip.html#ad8ebdc112d561b2fc072a77bc9528ced">n_active_slip</a>*1.d0) <span class="comment">! -- no. of sources per slip plane</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      print *, <span class="stringliteral">&#39;QSRC =&#39;</span>, qsrc, <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">!      tot_source = 1000</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a> = 50 <span class="comment">! MPa</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      sd_source_str = 5 <span class="comment">!MPa</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a> = <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a>*ev_convert*1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      sd_source_str = sd_source_str*ev_convert*1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      print *, <span class="stringliteral">&#39;Source strength =&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a>, xmu, xnu</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      print *, <span class="stringliteral">&#39;Source Strength MPa&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a>/ev_convert/1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5,</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;     $     xmu/ev_convert/1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-2, xe/ev_convert/1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-2</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      factor = xmu*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>/(2.d0*pi*(1.d0-xnu))</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      lnuc = factor/<a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      tol = lnuc/4.d0</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      print *, <span class="stringliteral">&#39;Lnuc =&#39;</span>, lnuc, <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>, <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      iseed1 = 1234</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      iseed2 = 567</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84">rmarin</a>(iseed1,iseed2)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keyword">allocate</span>(source_dist(1000))</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#a9de7ed02bffbdc8365d369962a9834be">rgauss</a>(source_dist, 1000,<a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a>,sd_source_str)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;c$$$      <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;c$$$         <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(I7,1X,2E15.8)&#39;</span>), i, source_dist(i),</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;c$$$     $        <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="comment">! Generate sources</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">! For now assume that qsrc always less than 1</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;c$$$      <span class="keywordflow">if</span> (qsrc &gt; 1.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;c$$$         nsrc = int(qsrc*10.d0)/10</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;c$$$         qsrc = qsrc-nsrc</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;c$$$<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">!      atom_exclusion = (atom_xmax-atom_xmin)/tan(phislp(1))</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keyword">allocate</span>(snuc(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keyword">allocate</span>(rnuc(3,<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keyword">allocate</span>(tnlaps(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keyword">allocate</span>(taui(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">!      allocate(nuc_pk_stress(3,1,nslp))</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keyword">allocate</span>(vprev(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(3,<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a>(3,<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keyword">allocate</span>(elem_dis(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keyword">allocate</span>(bout(2,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keyword">allocate</span>(sdis_out(2,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keyword">allocate</span>(sdis_out1(2,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(<a class="code" href="namespacemod__dd__slip.html#a30016ebf6324cc82865b0d84417a4b68">mxnobs</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keyword">allocate</span>(<a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a>(<a class="code" href="namespacemod__dd__slip.html#a30016ebf6324cc82865b0d84417a4b68">mxnobs</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>))</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a> = 0</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a> = 0.0d0</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a> = 0.0d0</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      vprev = 0.0d0</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a> = 0</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a> = 0.0d0</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">rold</a> = 0.0d0</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      elem_dis = 0</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a> = 0</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      rnuc = 0.0d0</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      snuc = 0.0d0</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a> = 0.0d0</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a> = 0.0d0</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      tnlaps = 0.0d0</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      taui = 0.0d0</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      bout = 0.0d0</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      sdis_out = 0.0d0</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      sdis_out1 = 0.0d0</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a> = 0</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a> = 0.0d0</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a> = 0.0d0</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      ii = 0</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      print *, <span class="stringliteral">&#39;QSRC = &#39;</span>, qsrc</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;         li=<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;         cphi = cosphi(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp))</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;         xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         yend = yendslp(islp)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         <span class="keywordflow">if</span> (li &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            dlmax = abs(yend-ystart)/abs(sphi)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            dlmax = xend-xstart</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;c$$$         <span class="keyword">write</span>(*,fmt=<span class="stringliteral">&#39;(A20,1X,2I7,5(1X,E15.8))&#39;</span>), <span class="stringliteral">&#39;Slip plane&#39;</span>,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;c$$$     $        islp, li, xstart, xend, ystart, yend, dlmax</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      print *, <span class="stringliteral">&#39;Source generation&#39;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      islp = 2</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      print *, <span class="stringliteral">&#39;Total slip planes = &#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;c$$$      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (islp &lt;= <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;c$$$         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;c$$$         cphi = cosphi(li)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;c$$$         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;c$$$         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;c$$$         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;c$$$         xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;c$$$         yend = yendslp(islp)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;c$$$         <span class="keywordflow">if</span> (li &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;c$$$            dlmax = abs(yend-ystart)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;c$$$     $           /abs(sphi)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;c$$$         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;c$$$            dlmax = xend -xstart</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;c$$$         <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>(rand,2)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;c$$$</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;c$$$  <span class="comment">!        Hard code one source on +60 slip plane a little distacnce   away</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;c$$$            <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) &gt; 5.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>-1.d0 .and.</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;c$$$     $           <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) &lt; 5.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>+1.d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;c$$$                  <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;c$$$                     <span class="keywordflow">if</span> (yendslp(islp) &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;c$$$                        <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;c$$$                           dlengthslp = lnuc + 100.0d0 + rand(1)*lnuc</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;c$$$                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;c$$$                           dlengthslp = 2.d0*lnuc + 100.0d0 + rand(1)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;c$$$     $                          *lnuc</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;c$$$<span class="keywordflow">                        end if</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;c$$$                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;c$$$                        dlengthslp = 4.d0*lnuc + 100.0d0 + rand(1)*lnuc</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;c$$$<span class="keywordflow">                     end if</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;c$$$                     <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;c$$$                        <span class="keywordflow">if</span> (yendslp(islp) &lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;c$$$                           cycle</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;c$$$<span class="keywordflow">                        end if</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;c$$$<span class="keywordflow">                     end if</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;c$$$                     k = 1</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;c$$$                     <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) = k</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;c$$$                     <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp) = <a class="code" href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">avg_source_str</a></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;c$$$                     <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp) = lnuc</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;c$$$                     ii = ii + 1</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;c$$$                     snuc(k,islp) = dlengthslp </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;c$$$                     <span class="keywordflow">if</span> (yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;c$$$                        rnuc(1,k,islp) = xstart + dlengthslp*cphi</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;c$$$                        rnuc(2,k,islp) = ystart + dlengthslp*sphi</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;c$$$                        rnuc(3,k,islp) = 0.0</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;c$$$                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;c$$$                        <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) ==1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;c$$$                           rnuc(1,k,islp) = xstart - dlengthslp*cphi</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;c$$$                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;c$$$                           rnuc(1,k,islp) = xstart+abs(dlengthslp*cphi)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;c$$$<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;c$$$                        rnuc(2,k,islp) = -(ystart + dlengthslp*sphi)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;c$$$                        rnuc(3,k,islp) = 0.0</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;c$$$<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;c$$$                     <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(k,islp) = fe_locate(rnuc(:,k,islp),1)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;c$$$                     <span class="keyword">write</span>( *,fmt=<span class="stringliteral">&#39;(A10,1X,3(1x,E15.7))&#39;</span>) <span class="stringliteral">&#39;Coords are&#39;</span>,</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;c$$$     $                    snuc(k,islp),rnuc(1,k,islp), rnuc(2,k,islp)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;c$$$                     print *, <span class="stringliteral">&#39;Located in Element &#39;</span>, <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(k,islp)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;c$$$                     print *, <span class="stringliteral">&#39;Islp = &#39;</span>, islp, <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp), cphi, sphi</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;c$$$c$$$                     <span class="keywordflow">exit</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;c$$$<span class="keywordflow">                  endif</span> </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;c$$$            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;c$$$               <span class="keywordflow">goto</span> 10</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;c$$$         <span class="keywordflow">else</span> </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;c$$$            <span class="keywordflow">goto</span> 10</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;c$$$<span class="comment">!     Generate source randomly from gaussian distribution</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;c$$$  </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;c$$$         <span class="keywordflow">if</span> (rand(1) &lt;= qsrc) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;c$$$            accept = .false.</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;c$$$            k = 1</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;c$$$            ii = ii + 1</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;c$$$            <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;c$$$               <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp) = source_dist(ii)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;c$$$            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;c$$$               <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp) = source_dist(ii)*10</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;c$$$            <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp) = factor/<a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;c$$$            <span class="keywordflow">if</span> (dlmax &lt; 2.d0*<a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp)) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;c$$$c$$$  print *, <span class="stringliteral">&#39;Rejecting slip plane&#39;</span>, ii, islp, li,</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;c$$$c$$$  $              dlmax,(2.d0*<a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp)), <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;c$$$               <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp) = 0.0d0</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;c$$$               <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp) = 0.0d0</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;c$$$               ii = ii -1</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;c$$$               islp = islp + 1</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;c$$$               <span class="keywordflow">goto</span> 10</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;c$$$            <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) = k</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;c$$$</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;c$$$            <span class="keywordflow">do</span> <span class="keywordflow">while</span> (accept == .false.)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;c$$$               <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>(rand1,2)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;c$$$               dlengthslp = rand1(1)*(dlmax)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;c$$$               <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) == 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;c$$$                  <span class="keywordflow">if</span> (abs(ystart) &gt; atom_ymax + <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp)*2.0d0)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;c$$$     $                 <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;c$$$                     <span class="keywordflow">if</span> (xstart + dlengthslp &lt; <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a> .or.</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;c$$$     $                    xstart + dlengthslp &gt; <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;c$$$                        accept = .true.</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;c$$$<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;c$$$<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;c$$$               <span class="keywordflow">if</span> (dlengthslp &gt; <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp)/2.d0 + tol/2.d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;c$$$                  <span class="keywordflow">if</span> (dlengthslp &lt; dlmax - <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(k,islp)/2.d0-tol/2.d0)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;c$$$     $                 <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;c$$$                     accept = .true.</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;c$$$<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;c$$$<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;c$$$            snuc(k,islp) = dlengthslp</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;c$$$            print *, <span class="stringliteral">&#39;Source no. generated = &#39;</span>, ii, <span class="stringliteral">&#39; on &#39;</span>, islp,</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;c$$$     $           li, <a class="code" href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">t_fr</a>(k,islp)/ev_convert/1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5, snuc(k,islp)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;c$$$</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;c$$$</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;c$$$            <span class="keywordflow">if</span> ( <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;c$$$               <span class="keywordflow">if</span> (yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;c$$$                  rnuc(1,k,islp) = xstart + dlengthslp*cphi</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;c$$$                  rnuc(2,k,islp) = ystart + dlengthslp*sphi</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;c$$$                  rnuc(3,k,islp) = 0.0</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;c$$$               <span class="keywordflow">else</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;c$$$                  <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;c$$$                     rnuc(1,k,islp) = xstart - dlengthslp*cphi</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;c$$$                     rnuc(1,k,islp) = xstart + abs(dlengthslp*cphi)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;c$$$                  rnuc(2,k,islp) = -(ystart + dlengthslp*sphi)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;c$$$                  rnuc(3,k,islp) = 0.0</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;c$$$<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;c$$$            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;c$$$               rnuc(1,k,islp) = xstart + dlengthslp*cphi</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;c$$$               rnuc(2,k,islp) = ystart</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;c$$$            </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;c$$$            <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(k,islp) = fe_locate(rnuc(:,k,islp),1)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;c$$$            <span class="keyword">write</span>( *,fmt=<span class="stringliteral">&#39;(A10,1X,3(1x,E15.7))&#39;</span>) <span class="stringliteral">&#39;Coords are&#39;</span>,</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;c$$$     $           snuc(k,islp),rnuc(1,k,islp), rnuc(2,k,islp)</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;c$$$            print *, <span class="stringliteral">&#39;Located in Element &#39;</span>, <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(k,islp)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;c$$$            islp = islp + 100</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;c$$$         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;c$$$            islp = islp + 100</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;c$$$ 10      <span class="keywordflow">continue</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;               print *, <span class="stringliteral">&#39;Source = &#39;</span>,i, islp, <a class="code" href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">elem_source</a>(i,islp)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      print *, <span class="stringliteral">&#39;Total no. of sources = &#39;</span>, ii</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a5dfead2bf24b6b827b7d9d4b8a4735e8">nntot</a> = ii</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a> = ii</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a> = <a class="code" href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">tot_source</a></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;       <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#aeffe22b6b2164f2f76d4d956460516a8">gen_slip_ends</a></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;c$$$      stop</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aff0b59f4ed0b06d8190a1f32c838dc1b">gen_sources</a></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aaf733690b66cf5dcca681c4e7712d9c9">plot_slip</a></div>
<div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aaf733690b66cf5dcca681c4e7712d9c9"> 1655</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,li,islp,ifile</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <span class="keywordtype">integer</span> :: kk(3)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordtype">double precision</span> :: x, y, xstart,xend, ystart, yend, sn,x1,y1</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordtype">double precision</span> :: cphi,sphi,tphi</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordtype">character*80</span> filename</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordtype">integer</span> :: tot_obs, tot_source, tot_pts</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;c$$$      filename=<span class="stringliteral">&#39;slip_lines.plt&#39;</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;c$$$      ifile = 999</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;c$$$      <span class="keyword">open</span>(unit=ifile,file=filename,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;c$$$      <span class="keyword">write</span>(999,*) <span class="stringliteral">&#39;Variables = X Y&#39;</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;c$$$            cphi = cosphi(li)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;c$$$            sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;c$$$            tphi = sphi/cphi</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;c$$$            xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;c$$$            xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;c$$$            ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;c$$$            yend = yendslp(islp)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;c$$$            <span class="keyword">write</span>(999,*) <span class="stringliteral">&quot;Zone T = line&quot;</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;c$$$            <span class="keyword">write</span>(999,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) xstart, ystart</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;c$$$            <span class="keyword">write</span>(999,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) xend, yend</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;c$$$      <span class="keyword">close</span>(ifile)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      filename = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      filename = <span class="stringliteral">&#39;source_obs.vtk&#39;</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      tot_obs = 0</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      tot_source = 0</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      tot_pts = 0</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;         tot_source = tot_source + <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;         tot_obs = tot_obs + <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;         tot_pts = tot_pts + <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) + <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      <span class="keyword">open</span>(unit=ifile,file=filename,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;# vtk DataFile Version 2.0&#39;</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Strains from CADD&#39;</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;ASCII&#39;</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;DATASET UNSTRUCTURED_GRID&#39;</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(A6,1x,I7,1x,A5)&#39;</span>) <span class="stringliteral">&#39;POINTS&#39;</span>,tot_pts,<span class="stringliteral">&#39;float&#39;</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;         cphi = cosphi(li)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;         yend = yendslp(islp)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">!     Sources are written first</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            sn = snuc(i,islp)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;               x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sn*cphi</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;               y1 = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sn*sphi</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;               <span class="keywordflow">if</span> (li == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                  x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) - sn*cphi</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                  x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + abs(sn*cphi)</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;               y1 = -(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sn*sphi)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(3(1X,E14.6))&#39;</span>) x1, y1, 0.0d0</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">!     Obstacles are written next</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            sn = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(i,islp)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            <span class="keywordflow">if</span> (yend &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;               x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + sn*cphi</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;               y1 = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sn*sphi</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;               <span class="keywordflow">if</span> (li == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                  x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) - sn*cphi</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                  x1 = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + abs(sn*cphi)</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;               y1 = -(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + sn*sphi)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(3(1X,E14.6))&#39;</span>) x1, y1, 0.0d0          </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keyword">write</span>(ifile,*)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(A5,1X,I7,1X,I7)&#39;</span>) <span class="stringliteral">&#39;CELLS&#39;</span>, tot_pts, 2*tot_pts</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keywordflow">do</span> i =1, tot_pts</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;         <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(2(1X,I7))&#39;</span>) 1, i-1</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keyword">write</span>(ifile,*)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(A10,1X,I7)&#39;</span>) <span class="stringliteral">&#39;CELL_TYPES&#39;</span>, tot_pts</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">do</span> i = 1, tot_pts</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;         <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(5(1x,I7))&#39;</span>) 1</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;POINT_DATA&#39;</span>, tot_pts</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;SCALARS SO integer 1&#39;</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;LOOKUP_TABLE default&#39;</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keywordflow">do</span> islp = 1, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(I7)&#39;</span>) 1</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;         <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="keyword">write</span>(ifile,<span class="stringliteral">&#39;(I7)&#39;</span>) 2</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;c$$$      <span class="keyword">write</span>(999,*) <span class="stringliteral">&#39;Variables = X Y&#39;</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;c$$$</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;c$$$      kk = 0</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = nuc1&#39;</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;c$$$                  si = snuc(i,islp)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;c$$$                  <span class="keywordflow">if</span> ( yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;c$$$                     x = xstart - cphi*si</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;c$$$                     y = ystart - sphi*si</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = nuc2&#39;</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;c$$$</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 2) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;c$$$                  si = snuc(i,islp)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;c$$$                  <span class="keywordflow">if</span> ( yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;c$$$                     x = xstart - cphi*si</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;c$$$                     y = ystart - sphi*si</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = nuc3&#39;</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;c$$$</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;c$$$                  si = snuc(i,islp)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;c$$$</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;c$$$</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = obs1&#39;</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;c$$$                  si = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(i,islp)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;c$$$                  <span class="keywordflow">if</span> ( yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;c$$$                     x = xstart - cphi*si</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;c$$$                     y = ystart - sphi*si</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = obs2&#39;</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;c$$$</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 2) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;c$$$                  si = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(i,islp)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;c$$$                  <span class="keywordflow">if</span> ( yend &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;c$$$                     x = xstart - cphi*si</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;c$$$                     y = -(ystart + sphi*si)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;c$$$<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;c$$$      <span class="keyword">write</span>(ifile, *) <span class="stringliteral">&#39;Zone T = obs3&#39;</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;c$$$</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;c$$$      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;c$$$            li =<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;c$$$            <span class="keywordflow">if</span> (li .eq. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;c$$$               cphi = cosphi(li)</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;c$$$               sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;c$$$               tphi = sphi/cphi</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;c$$$               xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;c$$$               xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;c$$$               ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;c$$$               yend = yendslp(islp)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;c$$$               <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;c$$$                  si = <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(i,islp)</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;c$$$                     x = xstart + cphi*si</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;c$$$                     y = ystart + sphi*si</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;c$$$                  <span class="keyword">write</span>(ifile,fmt=<span class="stringliteral">&#39;(2(1X,E18.11))&#39;</span>) x,y</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;c$$$<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;c$$$<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;c$$$<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keyword">close</span>(ifile)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aaf733690b66cf5dcca681c4e7712d9c9">plot_slip</a></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#abcf9c3d7803c5c67dc3e0a84d482f0e5">gen_obstacles</a></div>
<div class="line"><a name="l01928"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#abcf9c3d7803c5c67dc3e0a84d482f0e5"> 1928</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordtype">double precision</span> :: xe, xnu, xlambda, xmu, pi</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keywordtype">double precision</span> :: cc(6,6)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keywordtype">integer</span> :: i_elas, inuc</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keyword">common</span> /elastic/ xe, xnu, xlambda, xmu, cc, i_elas</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l,li, ii, islp, iseed1, iseed2, fe_locate</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keywordtype">logical</span> :: accept</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keywordtype">double precision</span> :: ev_convert, e, mu, nu, lambda, lnuc</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordtype">double precision</span> :: tobs, dlmax, dlengthslp</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keywordtype">double precision</span> :: x, x1, rand(2)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keywordtype">double precision</span> :: sphi, cphi, xstart, ystart,xend,yend</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keywordtype">double precision</span> :: x_lobs_nuc, xhold, xtemp</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordtype">integer</span> :: nobs_slip</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      pi = 3.1415926535898d0</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      ev_convert = 1.602176462d0</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      tobs = 1500.0d0 <span class="comment">! MPa</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      tobs = tobs*ev_convert*1.<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a>-5</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a> = 2000.0d0 <span class="comment">! Angstrom</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="comment">!     take care the lobs &gt; 2*Lnuc</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#af785590a174c8a5a974a979785d965f7">lobs_max</a> = 1.5d0*<a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">lobs_min</a> = 0.5d0*<a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      ii = 0</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      iseed1 = 111</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      iseed2 = 222</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84">rmarin</a>(iseed1,iseed2)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;         i = 0</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;         li = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;         cphi = cosphi(li)</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;         sphi = <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;         xstart = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;         ystart = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;         xend = <a class="code" href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">xendslp</a>(islp)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;         yend = yendslp(islp)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp) &lt; 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            dlmax = abs(yend-ystart)/abs(sphi)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            dlmax = xend -xstart</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">! ------ Put special conditions for slip-plane 3  </span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;         <span class="keywordflow">if</span> (li .ne. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            x = (atom_ymax+15.0d0)/sphi</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            x = 0.0d0</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keywordflow">if</span> (dlmax &gt; 2.d0*<a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a>) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;               <span class="keywordflow">do</span> <span class="keywordflow">while</span> (x &lt; dlmax)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                  <span class="comment">!call ranmar(rand,2)</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                  accept = .false. </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                  k = 0</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (accept == .false.)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                      <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>(rand,2)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                     <span class="keywordflow">if</span> (i &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                        x1 = <a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a> + <a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a>*(rand(1)-0.5)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                        x1 = <a class="code" href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">lobs_min</a>*rand(1)</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                     x = x + x1</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                     accept = .true.</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                     <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a>(x,snuc(1:<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp),islp),<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp),</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;     $                    xhold,inuc)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                     x_lobs_nuc = max(<a class="code" href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">lobs</a>/3.0d0, <a class="code" href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">xlnuc</a>(inuc,islp))</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;c$$$                     <span class="keyword">write</span>( *,fmt=<span class="stringliteral">&#39;(A20,2I7,5(1X,E15.9))&#39;</span>)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;c$$$     $                    <span class="stringliteral">&#39;obstacle trial &#39;</span>, islp,k, x,</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;c$$$     $                    xhold,snuc(inuc,islp), x_lobs_nuc</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                     <span class="keywordflow">if</span> (xhold &lt; x_lobs_nuc) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                        accept = .false.</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                        x = x-x1</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                        k = k + 1</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                        <span class="keywordflow">if</span> (k &gt; 20) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                           x = x + <a class="code" href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">lobs_min</a></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                     <span class="keywordflow">if</span> (li .eq. 3) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                        <span class="keywordflow">if</span> (abs(ystart) &lt; atom_ymax + 15.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                           xtemp = xstart + x</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                           <span class="keywordflow">if</span> (xtemp &gt;= <a class="code" href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">atom_xmin</a> .and. xtemp &lt;=</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;     $                          <a class="code" href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">atom_xmax</a>)<span class="keywordflow">then</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                              accept = .false.</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="keywordflow">                           endif</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="keywordflow">                        endif</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="keywordflow">                     endif</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="keywordflow">                  end do</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                  <span class="keywordflow">if</span> (x &lt;= dlmax) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                     i = i + 1</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp) = <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp) + 1</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">sobs</a>(i,islp) = x</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                     <a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a>(i,islp) = tobs</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                     print *, islp,i,x, <a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a>(i,islp)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                     <span class="keywordflow">exit</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="keywordflow">               end do</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            print *, <span class="stringliteral">&#39;Total obstatcles on &#39;</span>, islp, <span class="stringliteral">&#39; = &#39;</span>, <a class="code" href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">nobs</a>(islp)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#abcf9c3d7803c5c67dc3e0a84d482f0e5">gen_obstacles</a></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a>(x,xlist,n,xhold,inuc)</div>
<div class="line"><a name="l02032"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece"> 2032</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="keywordtype">double precision</span> :: xlist(n), x, xhold, d</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordtype">integer</span> :: inuc, n, i</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      xhold = abs(x-xlist(1))</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      inuc = 1</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">do</span> i = 2, n</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;         d = abs(x-xlist(i))</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;         <span class="keywordflow">if</span> (d &lt; xhold) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            xhold = d</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            inuc = i</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9de7ed02bffbdc8365d369962a9834be">rgauss</a>(x, len, xmean, sd)</div>
<div class="line"><a name="l02050"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a9de7ed02bffbdc8365d369962a9834be"> 2050</a></span>&#160;<span class="comment">!     !$  --------------------------------------------------------------</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">!     -------------</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">!     !$  Generate a random array of variables x with a Gaussian</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">!     distribution</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">!     !$  with a mean value xmean and a standard deviation sd. The</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">!     routine uses a trick </span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">!     !$  found in </span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">!     !$  Roes, P.B.M Van Oorschot, H.J.L : Kansrekening and statistek.</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">!     DUM 1978</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">!     !$  The routine makes use of ranmar to generate random numbers and</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">!     assumes</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">!     !$  ramrin has been called before to initialize ranmar</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">!     !$  --------------------------------------------------------------</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">!     -------------</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordtype">implicit</span> <span class="keywordtype">double precision</span> (a-h, o-z)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordtype">double precision</span> :: pi </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keywordtype">integer</span> :: len</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordtype">double precision</span> :: rand(2), xmean, sd, x(len)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordtype">double precision</span> :: Pi2</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      pi = 3.1415926535898</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      pi2 = 2.d0*pi</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      n = len/2</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordflow">if</span> ((2*n) .ne. len) n = n+1</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      ix = 0</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">do</span> i = 1, n</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;           <span class="keyword">call </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>(rand,2)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;           v1 = rand(1)</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;           v2 = rand(2)</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;           scale = sd*sqrt(-2.0d0*log(v1))</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;           ix = ix + 1</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;           x(ix) = xmean + scale*cos(pi2*v2)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;           ix = ix + 1</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;         <span class="keywordflow">if</span> (ix &gt; len) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;         x(ix) = xmean + scale*sin(pi2*v2)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a9de7ed02bffbdc8365d369962a9834be">rgauss</a></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;c$$$<span class="keyword">      function </span><a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a>(x,xlist,n)</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;c$$$      <span class="keywordtype">implicit</span> <span class="keywordtype">double precision</span> (a-h, o-z)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;c$$$      <span class="keywordtype">double precision</span> :: xlist(n), x</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;c$$$<span class="comment">!     !$    print *, &#39;xmin1&#39;</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;c$$$<span class="comment">!     !$    do i = 1,n</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;c$$$<span class="comment">!     !$       print *, i, xlist(i)</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;c$$$<span class="comment">!     !$    end do</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;c$$$      <a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a> = abs(x-xlist(1))</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;c$$$      <span class="keywordflow">do</span> i = 2, n</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;c$$$         <a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a> = abs(x-xlist(i))</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;c$$$         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a> &lt; dmin) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;c$$$            <a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a> = <a class="code" href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">d</a></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;c$$$<span class="keywordflow">         end if</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;c$$$<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;c$$$      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;c$$$      end<span class="keyword"> function </span><a class="code" href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">xmin1</a></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">! This random number generator originally appeared in &quot;Toward a Universa</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">! Random Number Generator&quot; by George Marsaglia and Arif Zaman.          </span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">! Florida State University Report: FSU-SCRI-87-50 (1987)                </span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">! It was later modified by F. James and published in &quot;A Review of Pseudo</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">! random Number Generators&quot;                                             </span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">! THIS IS THE BEST KNOWN RANDOM NUMBER GENERATOR AVAILABLE.             </span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">!       (However, a newly discovered technique can yield                </span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">!         a period of 10^600. But that is still in the development stage</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">! It passes ALL of the tests for random number generators and has a peri</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">!   of 2^144, is completely portable (gives bit identical results on all</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">!   machines with at least 24-bit mantissas in the floating point       </span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">!   representation).                                                    </span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">! The algorithm is a combination of a Fibonacci sequence (with lags of 9</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">!   and 33, and operation &quot;subtraction plus one, modulo one&quot;) and an    </span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">!   &quot;arithmetic sequence&quot; (using subtraction).                          </span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">! On a Vax 11/780, this random number generator can produce a number in </span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">!    13 microseconds.                                                   </span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">!=======================================================================</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                                                        </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84">rmarin</a>(IJ,KL) </div>
<div class="line"><a name="l02133"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84"> 2133</a></span>&#160;<span class="comment">! This is the initialization routine for the random number generator RAN</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">! NOTE: The seed variables can have values between:    0 &lt;= IJ &lt;= 31328 </span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">!                                                      0 &lt;= KL &lt;= 30081 </span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">! The random number sequences created by these two seeds are of sufficie</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">! length to complete an entire calculation with. For example, if sveral </span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">! different groups are working on different parts of the same calculatio</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">! each group could be assigned its own IJ seed. This would leave each gr</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">! with 30000 choices for the second seed. That is to say, this random   </span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">! number generator can create 900 million different subsequences -- with</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">! each subsequence having a length of approximately 10^30.              </span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                                                        </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                                                                        </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      <span class="keywordtype">double precision</span> :: U(97), C, CD, CM </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      <span class="keywordtype">integer</span> I97, J97 </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="keywordtype">logical</span> TEST </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keyword">common</span> /raset1/ u, c, cd, cm, i97, j97, test </div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                                                        </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      test = .false. </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                                                                        </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keywordflow">if</span>( ij .lt. 0  .or.  ij .gt. 31328  .or.                          &amp;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;     &amp;    kl .lt. 0  .or.  kl .gt. 30081 ) <span class="keywordflow">then</span>                         </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;          print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&#39; The first random number seed must have a value &amp;</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp;between 0 and 31328&#39;</span>                                              </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;          print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39; The second seed must have a value between 0 and &amp;</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp;30081&#39;</span>                                                            </div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            stop </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="keywordflow">      endif</span> </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                                                                        </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      i = mod(ij/177, 177) + 2 </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      j = mod(ij    , 177) + 2 </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      k = mod(kl/169, 178) + 1 </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      l = mod(kl,     169) </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                                                        </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordflow">do</span> 2 ii = 1, 97 </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;         s = 0.0 </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;         t = 0.5 </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;         <span class="keywordflow">do</span> 3 jj = 1, 24 </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            m = mod(mod(i*j, 179)*k, 179) </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            i = j </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            j = k </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            k = m </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            l = mod(53*l+1, 169) </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            <span class="keywordflow">if</span> (mod(l*m, 64) .ge. 32) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;               s = s + t </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="keywordflow">            endif</span> </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            t = 0.5 * t </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    3    <span class="keywordflow">continue</span> </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;         u(ii) = s </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    2 <span class="keywordflow">continue</span> </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                                                                        </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      c = 362436.0 / 16777216.0 </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      cd = 7654321.0 / 16777216.0 </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      cm = 16777213.0 /16777216.0 </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                                                                        </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      i97 = 97 </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      j97 = 33 </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                                                                        </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      test = .true. </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">return</span> </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="keyword">      END subroutine </span><a class="code" href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84">rmarin</a></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                                                                        </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                                                                        </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>(RVEC, LEN) </div>
<div class="line"><a name="l02196"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f"> 2196</a></span>&#160;<span class="comment">! This is the random number generator proposed by George Marsaglia in   </span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">! Florida State University Report: FSU-SCRI-87-50                       </span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">! It was slightly modified by F. James to produce an array of pseudorand</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">! numbers.                                                              </span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordtype">double precision</span> ::  RVEC(*) </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keywordtype">double precision</span> :: U(97), C, CD, CM </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      <span class="keywordtype">integer</span> I97, J97 </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      <span class="keywordtype">logical</span> TEST </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      <span class="keyword">common</span> /raset1/ u, c, cd, cm, i97, j97, test </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                                                                        </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="keywordtype">integer</span> ivec </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                                                                        </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keywordflow">if</span>( .NOT. test ) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;         print <span class="stringliteral">&#39;(A)&#39;</span>,<span class="stringliteral">&#39; Call the init routine (RMARIN) before calling RAN&amp;</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp;MAR&#39;</span>                                                              </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;         stop </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="keywordflow">      endif</span> </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                                                        </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="keywordflow">do</span> 100 ivec = 1, len </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;         uni = u(i97) - u(j97) </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;         <span class="keywordflow">if</span>( uni .lt. 0.0 ) uni = uni + 1.0 </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;         u(i97) = uni </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;         i97 = i97 - 1 </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;         <span class="keywordflow">if</span>(i97 .eq. 0) i97 = 97 </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;         j97 = j97 - 1 </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;         <span class="keywordflow">if</span>(j97 .eq. 0) j97 = 97 </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;         c = c - cd </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;         <span class="keywordflow">if</span>( c .lt. 0.0 ) c = c + cm </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;         uni = uni - c </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;         <span class="keywordflow">if</span>( uni .lt. 0.0 ) uni = uni + 1.0 </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;         rvec(ivec) = uni </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  100 <span class="keywordflow">continue</span> </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordflow">return</span> </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="keyword">      END subroutine </span><a class="code" href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">ranmar</a>                          </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f">assign_disloc_only</a>(dd1)</div>
<div class="line"><a name="l02232"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f"> 2232</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__dd__slip_1_1dd.html">dd</a>),<span class="keywordtype">dimension(tot_disl)</span>:: dd1</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">!-----------------------------------------------------</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">! Local variables</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">!------------------------</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="keywordtype">integer</span> :: islp, i,j, k,l,Ntot, Ntotmax,iib</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="keywordtype">double precision</span> :: x,y,s,si</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="keywordtype">double precision</span> :: maxx, maxy, minx,miny, pii</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      maxx = 0.d0; maxy = 0.d0; minx = 0.d0; miny = 0.d0</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <a class="code" href="namespacemod__dd__slip.html#a0bf223b3567d76ff14185978469edd1a">range_</a> = 2.d0*<a class="code" href="namespacemod__dd__slip.html#a28c51187b58901a027c3d317b617e86f">process_xmax</a> + 1000.0d0</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      pii = 2.d0*asin(1.d0)</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      ntotmax = <a class="code" href="namespacemod__dd__slip.html#a6ebc2746ce470503e03c1a07a8e14359">mxnslp</a>*(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>+<a class="code" href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mxnnuc</a>)</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      print *, <span class="stringliteral">&#39;Size of dd1 entering assign is &#39;</span>,<span class="keyword">size</span>(dd1), <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      k = 1;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      print *,<span class="stringliteral">&#39;Dislocations are &#39;</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">! ----- Read in the dislocations-------------------------------------</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">!               if (elem_dis(i,islp) .ne. 0) then </span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;               iib = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;               si = <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;c$$$               x = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + si * cosphi(iib) </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;c$$$               y = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + si * <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib)  </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;               x = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(1,i,islp)</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;               y = <a class="code" href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">rdis</a>(2,i,islp)</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;               dd1(k)%xy=dcmplx(x,y)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;               dd1(k)%slipangle = <a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(iib)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;               dd1(k)%burgers_dd(1) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;               dd1(k)%burgers_dd(2) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*cosphi(iib)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;               dd1(k)%burgers_dd(3) = <a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib) </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;               dd1(k)%slipplane_no = islp</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;               dd1(k)%stype = 1</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;               dd1(k)%velocity = vprev(i,islp)*</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;     $              cmplx(cosphi(iib),<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib))</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;               print *, i,islp, <a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp), <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;               k = k + 1</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">!               if (k &gt;= tot_disl ) print *,k</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">!               end do</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      print *, <span class="stringliteral">&#39;End Dislocations&#39;</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      print *, <span class="stringliteral">&#39;-------------------------------------------------------&#39;</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="comment">!tot_disloc = k-1</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f">assign_disloc_only</a></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a2c770b7a4f80a17980a3b3ad0c046485">assign_source_only</a>(dd1)</div>
<div class="line"><a name="l02282"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a2c770b7a4f80a17980a3b3ad0c046485"> 2282</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__dd__slip_1_1dd.html">dd</a>),<span class="keywordtype">dimension(tot_size)</span> :: dd1</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">!----------------------------------------------------</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">! Local variables</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">!-----------------------------------------------------</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="keywordtype">integer</span> :: islp, i,j, k,l,Ntot, Ntotmax,iib</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordtype">double precision</span> :: x,y,s,si</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">!----------------------------------------------------</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      k = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a> + 1</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordflow">do</span> islp = 1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp) &gt; 0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            <span class="keywordflow">do</span> i = 1,<a class="code" href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">nnuc</a>(islp)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;               iib = <a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;               si = snuc(i,islp)</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;c$$$               x = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + si * cosphi(iib) </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;c$$$               y = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + si * <a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib)  </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;               x = rnuc(1,i,islp)</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;               y = rnuc(2,i,islp)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;c$$$               <span class="keywordflow">if</span> (yendslp(islp) &gt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;c$$$                  x = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + si*cosphi(iib)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;c$$$                  y = <a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + si*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;c$$$               <span class="keywordflow">else</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;c$$$                  <span class="keywordflow">if</span> (iib == 1) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;c$$$                     x = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) - si*cosphi(iib)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;c$$$                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;c$$$                     x = <a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp) + abs(si*cosphi(iib))</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;c$$$<span class="keywordflow">                  end if</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;c$$$                  y = -(<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp) + si*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib))</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;c$$$<span class="keywordflow">               end if</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;               <span class="keywordflow">if</span> (y == 0 ) y = 1.e-9 </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;               <span class="keywordflow">if</span> (x == 0) x = 1.e-9</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;               dd1(k)%xy=cmplx(x,y)</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;               dd1(k)%slipangle = <a class="code" href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">phislp</a>(iib)</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;               dd1(k)%burgers_dd(1) = <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;               dd1(k)%burgers_dd(2) = <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>*cosphi(iib)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;               dd1(k)%burgers_dd(3) = <a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>*<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(iib) </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;               dd1(k)%slipplane_no = islp</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;               dd1(k)%stype = 2</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;               dd1(k)%velocity = 0.d0</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;               k = k + 1                    </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="keywordflow">         endif</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      print *, <span class="stringliteral">&#39;Total size =&#39;</span>, <a class="code" href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">tot_size</a>, k-1</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="comment">!tot_size = k -1;</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a2c770b7a4f80a17980a3b3ad0c046485">assign_source_only</a></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4">calcforce</a>(dd1, start, finish)</div>
<div class="line"><a name="l02330"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4"> 2330</a></span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      <span class="keywordtype">double precision</span> :: xe, xnu, xlambda, xmu</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="keywordtype">double precision</span> :: cc(6,6)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <span class="keywordtype">integer</span> :: i_elas</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keyword">common</span> /elastic/ xe, xnu, xlambda, xmu, cc, i_elas</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      <span class="keywordtype">type</span>(<a class="code" href="structmod__dd__slip_1_1dd.html">dd</a>), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(inout)</span> :: dd1</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      <span class="keywordtype">double complex</span> :: b,  bc,t,ct, t1, ct1, tmp1,im,tc,zph, zmh, czmh,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;     $     czph, zstar, z2, z3, zx</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordtype">double complex</span> :: phi1, phi2, phi11, z, z0, zc, z0c, phi2c,zi,z0i,</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;     $     zic, z0ic, th, tmp2, dzds</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="keywordtype">double precision</span> :: sig11, sig12, sig22, bi, sin2i, cos2i, fg, fc</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;     $     ,fgg, s11, s12, s22</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="keywordtype">double complex</span> :: phi1z, phi2z, phi11z, tmp1z, tmp2z, gz</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <span class="keywordtype">double precision</span> :: sig11z, sig12z, sig22z</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k, start, start1,finish, finish1</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="keywordtype">double precision</span> :: e, mu, nu, factor, h, rcore,x, y, x0,pii</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(2)</span> :: zstar1(2),zstar2(2), z1(2)</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      rcore = 2.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      pii = 2.d0*asin(1.d0)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;c$$$      start = 1</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;c$$$      finish = <span class="keyword">size</span>(dd1)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      start1 = 1</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      finish1 = <a class="code" href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">tot_disl</a></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      im = cmplx(0.,1.)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      mu = xmu</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      nu = xnu</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      factor = mu/(4.*pii*(1-nu))</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">!     print *, &#39;Factor = &#39;, factor</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <span class="keywordflow">do</span> i = start,finish</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;         dd1(i)%forced = 0.d0</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;         dd1(i)%forcedg = 0.d0</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;         dd1(i)%phi1 = 0.d0; dd1(i)%phi2 = 0.d0; dd1(i)%phi11 = 0.d0;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;         dd1(i)%dphi1 = 0.d0; dd1(i)%dphi2 = 0.d0; dd1(i)%dphi11 = 0.d0;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;         phi1 = 0.d0; phi2 = 0.d0; phi11 = 0.d0; sig11 = 0.0d0; sig12 =</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;     $        0.0d0; sig22 = 0.d0;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;         phi1z = 0.d0; phi2z = 0.d0; phi11z = 0.d0; sig11z = 0.d0;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;     $        sig12z = 0.d0; sig22z = 0.d0;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;         </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;         z = dd1(i)%xy</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;         zc = conjg(z)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">!     write (*,fmt=&#39;(I2,1x,2E12.5,2x,2e12.5)&#39;)i, z,</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">!     cmplx(dd1(i)%burgers_dd(2),dd1(i)%burgers_dd(3))</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;         sig11 = 0.; sig12 = 0.; sig22 = 0.</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;         <span class="keywordflow">do</span> j = start1, finish1</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;            tmp1z = 0.d0; tmp2z = 0.d0;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            z0 = dd1(j)%xy</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            z0c = conjg(z0)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;            b = cmplx(dd1(j)%burgers_dd(2),dd1(j)%burgers_dd(3))</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            bc = conjg(b)</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <span class="keywordflow">if</span> (abs(z-z0) &gt; 2*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;               phi1 = -im*factor*b/(z-z0);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;               phi11 =  im*factor*b/((z-z0)*(z-z0));</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;               phi2 = im*factor*bc/(z-z0)</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;               tmp1 = 2.d0*(phi1 + conjg(phi1));</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;               tmp2 = -2.d0*((z-z0)*conjg(phi11) + conjg(phi2))</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;               </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;               </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;               phi1z = im*factor*b/((z-z0)*(z-z0));</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;               phi11z =  -2.d0*im*factor*b/((z-z0)*(z-z0)*(z-z0));</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;               phi2z = -im*factor*bc/((z-z0)*(z-z0))</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;               tmp1z = 2.d0*(phi1z + conjg(phi1z));</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;               tmp2z = -2.d0*((z-z0)*conjg(phi11z) + conjg(phi2z))</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;               </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;               sig11z = sig11z + <span class="keywordtype">real</span>(0.5d0*(tmp1z + tmp2z))</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;               sig22z = sig22z + <span class="keywordtype">real</span>(0.5d0*(tmp1z - tmp2z))</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;               sig12z = sig12z + aimag(0.5d0*(tmp2z))</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;               sig11 = sig11 + <span class="keywordtype">real</span>(0.5d0*(tmp1 + tmp2))</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;               sig22 = sig22 + <span class="keywordtype">real</span>(0.5d0*(tmp1 - tmp2))</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;               sig12 = sig12 + aimag(0.5d0*(tmp2))</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;               t = z-z0</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;               <span class="keywordflow">if</span> (i .ne. j) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                  <span class="keywordflow">if</span> (<span class="keywordtype">real(t)</span> == 0) then</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                     th = dcmplx(0,asin(sin(dd1(j)%slipangle)))</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                     th = dcmplx(0,aimag(log(t)))</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="keywordflow">                  endif</span> </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                  zstar = rcore*exp(th)</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                  phi1 = -im*factor*b/zstar</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                  phi11 = im*factor*b/(zstar*zstar)</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                  phi2 = im*factor*bc/(zstar)</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                  tmp1 = 2.d0*(phi1 + conjg(phi1));</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                  tmp2 = -2.d0*((z-z0)*conjg(phi11) + conjg(phi2))</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                  sig11 = sig11 + <span class="keywordtype">real</span>(0.5d0*(tmp1 + tmp2))</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                  sig22 = sig22 + <span class="keywordtype">real</span>(0.5d0*(tmp1 - tmp2))</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                  sig12 = sig12 + aimag(0.5d0*(tmp2))</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;         sin2i = sin(2*dd1(i)%slipangle)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;         cos2i = cos(2*dd1(i)%slipangle)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;         bi = dd1(i)%burgers_dd(1)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;         fg = dd1(i)%burgers_dd(1)*((sig22-sig11)*0.5*sin2i +</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;     $        sig12*cos2i)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;         dd1(i)%forced = dd1(i)%forced + fg</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;         fgg = dd1(i)%burgers_dd(1)*((sig22z-sig11z)*0.5*sin2i + sig12z</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;     $        *cos2i)</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;         dd1(i)%forcedg= dd1(i)%forcedg + fgg</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;         <span class="comment">!print *, &#39;xxxxx&#39;, i, dd1(i)%burgers_dd,dd1(i)%forced</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="keywordflow">      enddo</span>         </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4">calcforce</a></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        </div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#a27cce4a11717d32f22eb8df7b2b1608f">dislp</a> (r,u)</div>
<div class="line"><a name="l02438"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#a27cce4a11717d32f22eb8df7b2b1608f"> 2438</a></span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">!     Determine displacement vector u at node n caused by dislocations</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">!     </span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">!     bout(1,islp) = total length of Burgers vectors of dislocations having</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">!     moved out of the bottom side (1) of the cell</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">!     Edition log:</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">!     06/10/94 The field of escaped dislocations is corrected to b/4</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="keywordtype">double precision</span> u(3), r(3)</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <span class="keywordtype">double precision</span> dxx, dyy, r2, rcore, dxi, dyi, cosi, sini, r1</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="keywordtype">double precision</span> dx2, dy2, a, pi, t, u1, u2, dx0, dy0, x,y,dxy2</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordtype">double precision</span> xnu, xmu, cc(6,6), xlambda, xe</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <span class="keywordtype">integer</span> i_elas</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="keyword">common</span> /elastic/ xe, xnu, xlambda, xmu, cc, i_elas</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordtype">integer</span> i, j, islp, li</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keywordtype">double precision</span> sign1(2)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      x = r(1)</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      y = r(2)</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      pi = 2.d0*asin(1.0d0)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      print *, <span class="stringliteral">&#39;dislp&#39;</span>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>,xnu</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">!     </span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">!     </span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">!.....For each node, loop over all active dislocations inside the cell</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      u(1)=0.0d0</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      u(2)=0.0d0</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <span class="keywordflow">do</span> 2 islp=1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;         li=<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;         sini=<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;         cosi=cosphi(li)</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         dx0=x-<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         dy0=y-<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         dxi= dx0*cosi+dy0*sini</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         dyi=-dx0*sini+dy0*cosi</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;         u1=0.0d0</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;         u2=0.0d0</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;         <span class="keywordflow">do</span> 4 i=1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            rcore=2.0d0*dabs(<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp))</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            dxx=dxi-<a class="code" href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">sdis</a>(i,islp)</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            dyy=dyi</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            dx2=dxx*dxx</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            dy2=dyy*dyy</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            r2=dx2+dy2</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">!     Cut off when closer than core radius</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            <span class="keywordflow">if</span>(r2.lt.rcore**2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;               r1=sqrt(r2)</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;               dxx=dxx/r1*rcore</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;               dyy=dyy/r1*rcore</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;               dx2=dxx*dxx</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;               dy2=dyy*dyy</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;               r2=rcore**2</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            dxy2=dxx**2+dyy**2</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            a=<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)/2.0d0/pi/(1.0d0-xnu)</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <span class="keywordflow">if</span>(dyy.eq.0.0d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;               t=dsign(pi/2.0d0,dxx)</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;               t=datan(dxx/dyy)</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">!.....first the local displacements</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            u1=u1+a*(dxx*dyy/2.0d0/dxy2-(1.0d0-xnu)*t)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            u2=u2+a*(dyy**2/2.0d0/dxy2-(1.0d0-2.0d0*xnu)/4.0d0*</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;     $           log(dxy2/<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)**2))</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; 4    <span class="keywordflow">continue</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">!.....transform to global displacements</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      u(1)=u(1)+cosi*u1-sini*u2</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      u(2)=u(2)+sini*u1+cosi*u2</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      u(3) = 0.0d0</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; 2    <span class="keywordflow">continue</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">!.....Dislocations that have escaped from the cell previously:</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">!.....The displacement field generated by a + dislocation moved out at the</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">!.....right-hand side (2) is</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">!.....          b/4 for y&gt;yd</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">!.....   u(1)=</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">!.....         -b/4 for y&lt;yd</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">!.....Dislocations having moved out at the bottom side (1) generate</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">!.....displacements with the opposite sign.</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      sign1(1)=-1.0d0</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      sign1(2)= 1.0d0</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">do</span> 3 islp=1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      li=<a class="code" href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">locphi</a>(islp)</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      sini=<a class="code" href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">sinphi</a>(li)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      cosi=cosphi(li)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      dx0=x-<a class="code" href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">xslp</a>(islp)</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      dy0=y-<a class="code" href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">yslp</a>(islp)</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      dxi= dx0*cosi+dy0*sini</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      dyi=-dx0*sini+dy0*cosi</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      u1=0.0d0</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      u2=0.0d0</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160; <span class="comment">!     sout(1,islp) = -1.d10</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; <span class="comment">!     sout(2,islp) = 1.d10</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; <span class="comment">!      soutq = 1.d10</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordflow">do</span> 11 i=1,2</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordflow">if</span>(bout(i,islp).eq.0) <span class="keywordflow">goto</span> 11</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="comment">!soutq = sign1(i)*soutq</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        rcore=2.d0*<a class="code" href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">blen</a></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        dxx=dxi-sdis_out(i,islp)</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        dyy=dyi</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        dx2=dxx*dxx</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        dy2=dyy*dyy</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        r2=dx2+dy2</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">!       Cut off when closer than core radius</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">if</span>(r2.lt.rcore**2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;          r1=dsqrt(r2)</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;          dxx=dxx/r1*rcore</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;          dyy=dyy/r1*rcore</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;          dx2=dxx*dxx</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;          dy2=dyy*dyy</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;          r2=rcore**2</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        dxy2=dxx**2+dyy**2</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        a=bout(i,islp)/2.0d0/pi/(1.0d0-xnu)</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        <span class="keywordflow">if</span>(dyy.eq.0.0d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;          t=dsign(pi/2.0d0,dxx)</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;          t=datan(dxx/dyy)</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">!.....first the local displacements</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        <span class="keywordflow">if</span>(dyy.gt.0.0d0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;          u1=u1+sign1(i)*bout(i,islp)/4.0d0</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;          u1=u1-sign1(i)*bout(i,islp)/4.0d0</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="keywordflow">        endif</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        u2=u2+a*(dyy**2/2.0d0/dxy2-(1.0d0-2.0d0*xnu)/4.0d0*dlog(dxy2</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;     $       /bout(i,islp)**2))</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; 11     <span class="keywordflow">continue</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">!.....Now transform to global displacements</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      u(1)=u(1)+cosi*u1-sini*u2</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      u(2)=u(2)+sini*u1+cosi*u2</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160; 3    <span class="keywordflow">continue</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#a27cce4a11717d32f22eb8df7b2b1608f">dislp</a></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#aeba8fb187f64622088528a9e46949293">rlsdis</a>(tau)</div>
<div class="line"><a name="l02578"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#aeba8fb187f64622088528a9e46949293"> 2578</a></span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">! Release pinned dislocations when the resolved shear stress `tau&#39;</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">! exceeds a critical value</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="comment">! 08/04/01 dislocations pinned at junctions skipped at present</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordtype">double precision</span> :: tau(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>, <a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), tauii</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="keywordtype">integer</span> :: islp, i,j</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">do</span> islp=1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;         <span class="keywordflow">do</span> i=1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;               tauii=dabs(tau(i,islp))</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;               <span class="keywordflow">if</span> (tauii.gt.<a class="code" href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">tau_obs</a>(<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp),islp)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                  <span class="keyword">write</span>(6,625) i,islp,<a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp)</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; 625              <span class="keyword">format</span>(<span class="stringliteral">&#39; Disloc. &#39;</span>,i3,<span class="stringliteral">&#39; on slip plane &#39;</span>,i4</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;     $                 ,<span class="stringliteral">&#39; released from obstacle &#39;</span>,i2)</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                  <a class="code" href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">iobpin</a>(i,islp)=0</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#aeba8fb187f64622088528a9e46949293">rlsdis</a></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="namespacemod__dd__slip.html#afa545c808a099dcd5d4901d68905356d">undrex</a>(v,c)</div>
<div class="line"><a name="l02603"></a><span class="lineno"><a class="line" href="namespacemod__dd__slip.html#afa545c808a099dcd5d4901d68905356d"> 2603</a></span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">! Determine underrelaxation factor for updating dislocation positions.</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="comment">! Currently, underrelaxation with a factor 0.75 is used when the</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">! velocity of two like-signed dislocations (in pile-ups) changes sign</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">! as compared to the previous increment.</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">! In addition, underrelaxation with a factor 0.5 is used for ANY</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">! sign change in velocity</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment">! Edition log</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">! 02/09/96 Underrelaxation implemented also for any change of sig</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keywordtype">double precision</span> :: v(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>), c(<a class="code" href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mxndis</a>,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a>)</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="keywordtype">integer</span> :: i,j,k,l, islp</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keywordtype">double precision</span> :: bi</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keywordflow">do</span>  islp=1,<a class="code" href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">nslp</a></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;         <span class="keywordflow">do</span> i=1,<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            c(i,islp)=1.0d0</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            <span class="keywordflow">if</span>((v(i,islp)*vprev(i,islp))&lt; 0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;               c(i,islp)=0.5d0*c(i,islp)</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;               bi=<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(i,islp)</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;               j=i-1</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;               <span class="keywordflow">if</span>(j.ge.1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                  <span class="keywordflow">if</span>((bi*<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j,islp)).gt.0.0d0) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                     c(i,islp)=0.75d0*c(i,islp)</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;               j=i+1</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;               <span class="keywordflow">if</span>(j.le.<a class="code" href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">ndis</a>(islp)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                  <span class="keywordflow">if</span>((bi*<a class="code" href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">b_dd</a>(j,islp)).gt.0.0d0)  <span class="keywordflow">then</span> </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                     c(i,islp)=0.75d0*c(i,islp)</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="keywordflow">                  endif</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="keywordflow">               endif</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="keywordflow">         end do</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="keyword">      end subroutine </span><a class="code" href="namespacemod__dd__slip.html#afa545c808a099dcd5d4901d68905356d">undrex</a></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="keyword">      end module </span><a class="code" href="namespacemod__dd__slip.html">mod_dd_slip</a></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="keyword">      function </span><a class="code" href="mod__dd__slip_8f.html#a729f4c503d05e4d20833516b9b32b77b">tlce</a>(xx)</div>
<div class="line"><a name="l02645"></a><span class="lineno"><a class="line" href="mod__dd__slip_8f.html#a729f4c503d05e4d20833516b9b32b77b"> 2645</a></span>&#160;      <span class="keywordtype">implicit</span> <span class="keywordtype">double precision</span>(a-h,o-z)</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      <a class="code" href="mod__dd__slip_8f.html#a729f4c503d05e4d20833516b9b32b77b">tlce</a>=dint(xx*1.0d6)/1.0d6</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="keyword">      end function </span><a class="code" href="mod__dd__slip_8f.html#a729f4c503d05e4d20833516b9b32b77b">tlce</a></div>
<div class="ttc" id="namespacemod__dd__slip_html_a6ca1bfbcf018ab04c20fc2cb9028a042"><div class="ttname"><a href="namespacemod__dd__slip.html#a6ca1bfbcf018ab04c20fc2cb9028a042">mod_dd_slip::remove_disl_global</a></div><div class="ttdeci">subroutine remove_disl_global(idisl_slip)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00460">mod_dd_slip.f:460</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a09285994f0bef9b100c7f09eb93cb0f1"><div class="ttname"><a href="namespacemod__dd__slip.html#a09285994f0bef9b100c7f09eb93cb0f1">mod_dd_slip::nu_dd</a></div><div class="ttdeci">double precision nu_dd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00035">mod_dd_slip.f:35</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_adb3040c9331a4b47129809d1e4a82342"><div class="ttname"><a href="namespacemod__dd__slip.html#adb3040c9331a4b47129809d1e4a82342">mod_dd_slip::assign_disloc_global</a></div><div class="ttdeci">subroutine assign_disloc_global</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00627">mod_dd_slip.f:627</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a7db08b62ad55c89e76f9df3e94c8f1a4"><div class="ttname"><a href="namespacemod__dd__slip.html#a7db08b62ad55c89e76f9df3e94c8f1a4">mod_dd_slip::nslp</a></div><div class="ttdeci">integer nslp</div><div class="ttdoc">mxnslp –> max. number of slip planes mxnsys –> max. number of slip systems (default = 3) nsys –> C...</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00012">mod_dd_slip.f:12</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a17d514ce0e161af30b78833d2b77d6cd"><div class="ttname"><a href="namespacemod__dd__slip.html#a17d514ce0e161af30b78833d2b77d6cd">mod_dd_slip::put_in_bucket</a></div><div class="ttdeci">subroutine put_in_bucket(i, islp)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00482">mod_dd_slip.f:482</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a9de7ed02bffbdc8365d369962a9834be"><div class="ttname"><a href="namespacemod__dd__slip.html#a9de7ed02bffbdc8365d369962a9834be">mod_dd_slip::rgauss</a></div><div class="ttdeci">subroutine rgauss(x, len, xmean, sd)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02050">mod_dd_slip.f:2050</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ae42bfd37d77d5b60a1b308419ad70e5e"><div class="ttname"><a href="namespacemod__dd__slip.html#ae42bfd37d77d5b60a1b308419ad70e5e">mod_dd_slip::calc_bout</a></div><div class="ttdeci">subroutine calc_bout</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00497">mod_dd_slip.f:497</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_af027841fa78ddf728bb416e19b0c9cc1"><div class="ttname"><a href="namespacemod__dd__slip.html#af027841fa78ddf728bb416e19b0c9cc1">mod_dd_slip::tobs</a></div><div class="ttdeci">double precision tobs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a1b2749cec2077efaf41839d644e4bbc8"><div class="ttname"><a href="namespacemod__dd__slip.html#a1b2749cec2077efaf41839d644e4bbc8">mod_dd_slip::lobs_min</a></div><div class="ttdeci">double precision lobs_min</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00072">mod_dd_slip.f:72</a></div></div>
<div class="ttc" id="mod__dd__slip_8f_html_a729f4c503d05e4d20833516b9b32b77b"><div class="ttname"><a href="mod__dd__slip_8f.html#a729f4c503d05e4d20833516b9b32b77b">tlce</a></div><div class="ttdeci">function tlce(xx)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02645">mod_dd_slip.f:2645</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a9e32d184f05c6e2826991edc2fe9d5b7"><div class="ttname"><a href="namespacemod__dd__slip.html#a9e32d184f05c6e2826991edc2fe9d5b7">mod_dd_slip::mxndis</a></div><div class="ttdeci">integer mxndis</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00084">mod_dd_slip.f:84</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_af785590a174c8a5a974a979785d965f7"><div class="ttname"><a href="namespacemod__dd__slip.html#af785590a174c8a5a974a979785d965f7">mod_dd_slip::lobs_max</a></div><div class="ttdeci">double precision lobs_max</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00072">mod_dd_slip.f:72</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab7e22d2617bb4baba7fc3333ba5d25ae"><div class="ttname"><a href="namespacemod__dd__slip.html#ab7e22d2617bb4baba7fc3333ba5d25ae">mod_dd_slip::sdis_out_tol</a></div><div class="ttdeci">double precision sdis_out_tol</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00046">mod_dd_slip.f:46</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aeba8fb187f64622088528a9e46949293"><div class="ttname"><a href="namespacemod__dd__slip.html#aeba8fb187f64622088528a9e46949293">mod_dd_slip::rlsdis</a></div><div class="ttdeci">subroutine rlsdis(tau)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02578">mod_dd_slip.f:2578</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a5dfead2bf24b6b827b7d9d4b8a4735e8"><div class="ttname"><a href="namespacemod__dd__slip.html#a5dfead2bf24b6b827b7d9d4b8a4735e8">mod_dd_slip::nntot</a></div><div class="ttdeci">integer nntot</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00028">mod_dd_slip.f:28</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a2f19cd26e600789159456f993180021d"><div class="ttname"><a href="namespacemod__dd__slip.html#a2f19cd26e600789159456f993180021d">mod_dd_slip::rold</a></div><div class="ttdeci">double precision, dimension(:,:,:), allocatable rold</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00090">mod_dd_slip.f:90</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a86b9d7c187b0e62589cc7071ac4d5c6c"><div class="ttname"><a href="namespacemod__dd__slip.html#a86b9d7c187b0e62589cc7071ac4d5c6c">mod_dd_slip::mxnsys</a></div><div class="ttdeci">integer mxnsys</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00012">mod_dd_slip.f:12</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a2686443eb3db5b804d3076be4738726f"><div class="ttname"><a href="namespacemod__dd__slip.html#a2686443eb3db5b804d3076be4738726f">mod_dd_slip::xlnuc</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable xlnuc</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00062">mod_dd_slip.f:62</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a5d4c38eb284cfad22a15acc8f44d89c2"><div class="ttname"><a href="namespacemod__dd__slip.html#a5d4c38eb284cfad22a15acc8f44d89c2">mod_dd_slip::tot_obs</a></div><div class="ttdeci">integer tot_obs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00068">mod_dd_slip.f:68</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab11e53891373edb8847f95b3211e9eb9"><div class="ttname"><a href="namespacemod__dd__slip.html#ab11e53891373edb8847f95b3211e9eb9">mod_dd_slip::xslp</a></div><div class="ttdeci">double precision, dimension(:), allocatable xslp</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00038">mod_dd_slip.f:38</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aeffe22b6b2164f2f76d4d956460516a8"><div class="ttname"><a href="namespacemod__dd__slip.html#aeffe22b6b2164f2f76d4d956460516a8">mod_dd_slip::gen_slip_ends</a></div><div class="ttdeci">subroutine gen_slip_ends</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01287">mod_dd_slip.f:1287</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aebab0eb78f3f219f189a6dadd9f58cd5"><div class="ttname"><a href="namespacemod__dd__slip.html#aebab0eb78f3f219f189a6dadd9f58cd5">mod_dd_slip::gen_slip_planes</a></div><div class="ttdeci">subroutine gen_slip_planes(xmin, xmax, ymin, ymax,</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00143">mod_dd_slip.f:143</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a8592c181e3e838e42e3c1804fd576a72"><div class="ttname"><a href="namespacemod__dd__slip.html#a8592c181e3e838e42e3c1804fd576a72">mod_dd_slip::process_xmin</a></div><div class="ttdeci">double precision process_xmin</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00029">mod_dd_slip.f:29</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac5e8beda1fa506d1325720b664f5d20c"><div class="ttname"><a href="namespacemod__dd__slip.html#ac5e8beda1fa506d1325720b664f5d20c">mod_dd_slip::atom_xmin</a></div><div class="ttdeci">double precision atom_xmin</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00033">mod_dd_slip.f:33</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_afabe9557921d73145b1903a90b495691"><div class="ttname"><a href="namespacemod__dd__slip.html#afabe9557921d73145b1903a90b495691">mod_dd_slip::xendslp</a></div><div class="ttdeci">double precision, dimension(:), allocatable xendslp</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00038">mod_dd_slip.f:38</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a9bf7b9791d9dfcff4ab77df9f36964f7"><div class="ttname"><a href="namespacemod__dd__slip.html#a9bf7b9791d9dfcff4ab77df9f36964f7">mod_dd_slip::dtime_dd</a></div><div class="ttdeci">double precision dtime_dd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00019">mod_dd_slip.f:19</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a56108e7b1c1f9187611348ad367817d1"><div class="ttname"><a href="namespacemod__dd__slip.html#a56108e7b1c1f9187611348ad367817d1">mod_dd_slip::ndis</a></div><div class="ttdeci">integer, dimension(:), allocatable ndis</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00085">mod_dd_slip.f:85</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a1b284310d5cc3c40691c731783186435"><div class="ttname"><a href="namespacemod__dd__slip.html#a1b284310d5cc3c40691c731783186435">mod_dd_slip::tincr_sav</a></div><div class="ttdeci">double precision tincr_sav</div><div class="ttdoc">tincr —> DD timer (default = 1.d-11) tnuc —> Nucleation timer (default = 1.d-9). dtime_dd —> running DD time step Currently tnuc and tincr needs to be changed in the code </div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00019">mod_dd_slip.f:19</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a343d0dd2938aa21a57d02d2d9205434b"><div class="ttname"><a href="namespacemod__dd__slip.html#a343d0dd2938aa21a57d02d2d9205434b">mod_dd_slip::tnuc</a></div><div class="ttdeci">double precision tnuc</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00019">mod_dd_slip.f:19</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a84c62b0d215818af34317d22c3c04e4f"><div class="ttname"><a href="namespacemod__dd__slip.html#a84c62b0d215818af34317d22c3c04e4f">mod_dd_slip::assign_disloc_only</a></div><div class="ttdeci">subroutine assign_disloc_only(dd1)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02232">mod_dd_slip.f:2232</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a5a5837a35bf6bfb928a4930b54cf5089"><div class="ttname"><a href="namespacemod__dd__slip.html#a5a5837a35bf6bfb928a4930b54cf5089">mod_dd_slip::iobpin</a></div><div class="ttdeci">integer, dimension(:,:), allocatable iobpin</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00092">mod_dd_slip.f:92</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_abe71ffef9dd3a578892bd99f57144604"><div class="ttname"><a href="namespacemod__dd__slip.html#abe71ffef9dd3a578892bd99f57144604">mod_dd_slip::mu_dd</a></div><div class="ttdeci">double precision mu_dd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00035">mod_dd_slip.f:35</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a44c00d8628fe08b70796e6f904b940d1"><div class="ttname"><a href="namespacemod__dd__slip.html#a44c00d8628fe08b70796e6f904b940d1">mod_dd_slip::sinphi</a></div><div class="ttdeci">double precision, dimension(mxnsys) sinphi</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00036">mod_dd_slip.f:36</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a0bf223b3567d76ff14185978469edd1a"><div class="ttname"><a href="namespacemod__dd__slip.html#a0bf223b3567d76ff14185978469edd1a">mod_dd_slip::range_</a></div><div class="ttdeci">double precision range_</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00105">mod_dd_slip.f:105</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aa43723c6228da6af36b5ef1950e0e06b"><div class="ttname"><a href="namespacemod__dd__slip.html#aa43723c6228da6af36b5ef1950e0e06b">mod_dd_slip::nd</a></div><div class="ttdeci">integer nd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00084">mod_dd_slip.f:84</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a219c9587e77839191feb3723d12fb263"><div class="ttname"><a href="namespacemod__dd__slip.html#a219c9587e77839191feb3723d12fb263">mod_dd_slip::vcutoff</a></div><div class="ttdeci">double precision vcutoff</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aa767532767c5523fe5e4ec4565e2e8fb"><div class="ttname"><a href="namespacemod__dd__slip.html#aa767532767c5523fe5e4ec4565e2e8fb">mod_dd_slip::sobs</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable sobs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00071">mod_dd_slip.f:71</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a40bc2094f8ea058c8b7eb0f1e667eb35"><div class="ttname"><a href="namespacemod__dd__slip.html#a40bc2094f8ea058c8b7eb0f1e667eb35">mod_dd_slip::npile</a></div><div class="ttdeci">integer npile</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00084">mod_dd_slip.f:84</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a30016ebf6324cc82865b0d84417a4b68"><div class="ttname"><a href="namespacemod__dd__slip.html#a30016ebf6324cc82865b0d84417a4b68">mod_dd_slip::mxnobs</a></div><div class="ttdeci">integer mxnobs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00068">mod_dd_slip.f:68</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a9b9cf2223906f53f6bae978b3f70e32b"><div class="ttname"><a href="namespacemod__dd__slip.html#a9b9cf2223906f53f6bae978b3f70e32b">mod_dd_slip::move_disloc</a></div><div class="ttdeci">subroutine move_disloc(rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00774">mod_dd_slip.f:774</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac43cbb7509e6ae556301f24e6dfcd4d0"><div class="ttname"><a href="namespacemod__dd__slip.html#ac43cbb7509e6ae556301f24e6dfcd4d0">mod_dd_slip::b_dd</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable b_dd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00087">mod_dd_slip.f:87</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a004daac9f301139eee9242c420861fc5"><div class="ttname"><a href="namespacemod__dd__slip.html#a004daac9f301139eee9242c420861fc5">mod_dd_slip::for</a></div><div class="ttdeci">double precision for</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00105">mod_dd_slip.f:105</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab0d01d82f8bbe9bb679f135bb335964f"><div class="ttname"><a href="namespacemod__dd__slip.html#ab0d01d82f8bbe9bb679f135bb335964f">mod_dd_slip::ranmar</a></div><div class="ttdeci">subroutine ranmar(RVEC, LEN)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02196">mod_dd_slip.f:2196</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a49be0fa542db7f49550554d9cd103099"><div class="ttname"><a href="namespacemod__dd__slip.html#a49be0fa542db7f49550554d9cd103099">mod_dd_slip::of</a></div><div class="ttdeci">integer of</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00103">mod_dd_slip.f:103</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a43447a241b09db9d2b5f0e5c17d27347"><div class="ttname"><a href="namespacemod__dd__slip.html#a43447a241b09db9d2b5f0e5c17d27347">mod_dd_slip::nobs</a></div><div class="ttdeci">integer, dimension(:), allocatable nobs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00070">mod_dd_slip.f:70</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ae8eae8e7db9f581f4a38d204a2a6465c"><div class="ttname"><a href="namespacemod__dd__slip.html#ae8eae8e7db9f581f4a38d204a2a6465c">mod_dd_slip::dstar</a></div><div class="ttdeci">double precision dstar</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="disl__field_8f_html_ab6f89364197ee3e5c1b2969f8f3d8f5f"><div class="ttname"><a href="disl__field_8f.html#ab6f89364197ee3e5c1b2969f8f3d8f5f">disl_u</a></div><div class="ttdeci">subroutine disl_u(r0, burgers, th_e, th_s, r, u_out)</div><div class="ttdef"><b>Definition:</b> <a href="disl__field_8f_source.html#l00005">disl_field.f:5</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a53c50dfaacd2acedac0f46fc0070f557"><div class="ttname"><a href="namespacemod__dd__slip.html#a53c50dfaacd2acedac0f46fc0070f557">mod_dd_slip::rpile</a></div><div class="ttdeci">double precision rpile</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00091">mod_dd_slip.f:91</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac780b1944516254958ea2ef99067fcef"><div class="ttname"><a href="namespacemod__dd__slip.html#ac780b1944516254958ea2ef99067fcef">mod_dd_slip::dx_slip</a></div><div class="ttdeci">double precision dx_slip</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00045">mod_dd_slip.f:45</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a28c51187b58901a027c3d317b617e86f"><div class="ttname"><a href="namespacemod__dd__slip.html#a28c51187b58901a027c3d317b617e86f">mod_dd_slip::process_xmax</a></div><div class="ttdeci">double precision process_xmax</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00029">mod_dd_slip.f:29</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_afc16df362e68c4cef155b9f81b777d2a"><div class="ttname"><a href="namespacemod__dd__slip.html#afc16df362e68c4cef155b9f81b777d2a">mod_dd_slip::rmdisl</a></div><div class="ttdeci">subroutine rmdisl(i, islp, ar1, ar2, ar3, ar4)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00519">mod_dd_slip.f:519</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_afa545c808a099dcd5d4901d68905356d"><div class="ttname"><a href="namespacemod__dd__slip.html#afa545c808a099dcd5d4901d68905356d">mod_dd_slip::undrex</a></div><div class="ttdeci">subroutine undrex(v, c)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02603">mod_dd_slip.f:2603</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a1decd376e9f44627996734fbbe54b9b4"><div class="ttname"><a href="namespacemod__dd__slip.html#a1decd376e9f44627996734fbbe54b9b4">mod_dd_slip::calcforce</a></div><div class="ttdeci">subroutine calcforce(dd1, start, finish)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02330">mod_dd_slip.f:2330</a></div></div>
<div class="ttc" id="contri_8f_html_ac2443146a37d7fe86e9188711240347b"><div class="ttname"><a href="contri_8f.html#ac2443146a37d7fe86e9188711240347b">edge</a></div><div class="ttdeci">subroutine edge(VI, VJ, NPTS, NTRI, NEF, JW, X, Y, V, T, TN, W)</div><div class="ttdef"><b>Definition:</b> <a href="contri_8f_source.html#l01120">contri.f:1120</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_af951ef13a6271a2911d26f43c3f7bfce"><div class="ttname"><a href="namespacemod__dd__slip.html#af951ef13a6271a2911d26f43c3f7bfce">mod_dd_slip::tot_size</a></div><div class="ttdeci">integer tot_size</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00103">mod_dd_slip.f:103</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aaf11c8c5688adb47391a083b85a5aaca"><div class="ttname"><a href="namespacemod__dd__slip.html#aaf11c8c5688adb47391a083b85a5aaca">mod_dd_slip::t_fr</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable t_fr</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00062">mod_dd_slip.f:62</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ad0c0e918c73157f9ed34c0dd8bb9a4c1"><div class="ttname"><a href="namespacemod__dd__slip.html#ad0c0e918c73157f9ed34c0dd8bb9a4c1">mod_dd_slip::bdrag</a></div><div class="ttdeci">double precision bdrag</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a7818dde5c36d219d54d3d20473a6c738"><div class="ttname"><a href="namespacemod__dd__slip.html#a7818dde5c36d219d54d3d20473a6c738">mod_dd_slip::tot_disl</a></div><div class="ttdeci">integer tot_disl</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00084">mod_dd_slip.f:84</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aff0b59f4ed0b06d8190a1f32c838dc1b"><div class="ttname"><a href="namespacemod__dd__slip.html#aff0b59f4ed0b06d8190a1f32c838dc1b">mod_dd_slip::gen_sources</a></div><div class="ttdeci">subroutine gen_sources</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01350">mod_dd_slip.f:1350</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_af7244818b02606f77299af285861cbd4"><div class="ttname"><a href="namespacemod__dd__slip.html#af7244818b02606f77299af285861cbd4">mod_dd_slip::dislocations</a></div><div class="ttdeci">integer dislocations</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00103">mod_dd_slip.f:103</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a8246be3025f8e025e65e4b9f46958782"><div class="ttname"><a href="namespacemod__dd__slip.html#a8246be3025f8e025e65e4b9f46958782">mod_dd_slip::atom_xmax</a></div><div class="ttdeci">double precision atom_xmax</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00033">mod_dd_slip.f:33</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab4337df8fb73c06f644b9362e7087084"><div class="ttname"><a href="namespacemod__dd__slip.html#ab4337df8fb73c06f644b9362e7087084">mod_dd_slip::phisys</a></div><div class="ttdeci">double precision phisys</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00036">mod_dd_slip.f:36</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aa4787e27bc5ee443900f5339fbc9cf61"><div class="ttname"><a href="namespacemod__dd__slip.html#aa4787e27bc5ee443900f5339fbc9cf61">mod_dd_slip::nucleate_disl</a></div><div class="ttdeci">subroutine nucleate_disl(rhs)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01111">mod_dd_slip.f:1111</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a89adbbfc977cdad8339914640fd86804"><div class="ttname"><a href="namespacemod__dd__slip.html#a89adbbfc977cdad8339914640fd86804">mod_dd_slip::nsys</a></div><div class="ttdeci">integer nsys</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00012">mod_dd_slip.f:12</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a945c0ab11073da9d2867b3458ccb661d"><div class="ttname"><a href="namespacemod__dd__slip.html#a945c0ab11073da9d2867b3458ccb661d">mod_dd_slip::source_den</a></div><div class="ttdeci">double precision source_den</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00031">mod_dd_slip.f:31</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a2c770b7a4f80a17980a3b3ad0c046485"><div class="ttname"><a href="namespacemod__dd__slip.html#a2c770b7a4f80a17980a3b3ad0c046485">mod_dd_slip::assign_source_only</a></div><div class="ttdeci">subroutine assign_source_only(dd1)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02282">mod_dd_slip.f:2282</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ad3cae2b389aaaf707dd87a9e80f59bed"><div class="ttname"><a href="namespacemod__dd__slip.html#ad3cae2b389aaaf707dd87a9e80f59bed">mod_dd_slip::phislp</a></div><div class="ttdeci">double precision, dimension(mxnsys) phislp</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00036">mod_dd_slip.f:36</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_afb06abfdeadc119811107f8deddaceef"><div class="ttname"><a href="namespacemod__dd__slip.html#afb06abfdeadc119811107f8deddaceef">mod_dd_slip::dy_slip</a></div><div class="ttdeci">double precision dy_slip</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00045">mod_dd_slip.f:45</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a64c582628ada5570bc65a65da9cbbbf0"><div class="ttname"><a href="namespacemod__dd__slip.html#a64c582628ada5570bc65a65da9cbbbf0">mod_dd_slip::lobs</a></div><div class="ttdeci">double precision lobs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00072">mod_dd_slip.f:72</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a27cce4a11717d32f22eb8df7b2b1608f"><div class="ttname"><a href="namespacemod__dd__slip.html#a27cce4a11717d32f22eb8df7b2b1608f">mod_dd_slip::dislp</a></div><div class="ttdeci">subroutine dislp(r, u)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02438">mod_dd_slip.f:2438</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a3e47a7f2ff2e008a3bbfde65ecbeaee5"><div class="ttname"><a href="namespacemod__dd__slip.html#a3e47a7f2ff2e008a3bbfde65ecbeaee5">mod_dd_slip::disl_range_tol</a></div><div class="ttdeci">double precision disl_range_tol</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00046">mod_dd_slip.f:46</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a29d4380defcb47962125ce3cf2e1da42"><div class="ttname"><a href="namespacemod__dd__slip.html#a29d4380defcb47962125ce3cf2e1da42">mod_dd_slip::nshift_slip</a></div><div class="ttdeci">integer, dimension(:), allocatable nshift_slip</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00040">mod_dd_slip.f:40</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a7629f451a880c9b11533488ab813a05e"><div class="ttname"><a href="namespacemod__dd__slip.html#a7629f451a880c9b11533488ab813a05e">mod_dd_slip::jcnpin</a></div><div class="ttdeci">integer, dimension(:,:), allocatable jcnpin</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00092">mod_dd_slip.f:92</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab51ae4b35cb40e72a5fb4301b820d1b1"><div class="ttname"><a href="namespacemod__dd__slip.html#ab51ae4b35cb40e72a5fb4301b820d1b1">mod_dd_slip::idple</a></div><div class="ttdeci">integer, dimension(:,:), allocatable idple</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00092">mod_dd_slip.f:92</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a3df2e5ec92deacde38caa3f79568675b"><div class="ttname"><a href="namespacemod__dd__slip.html#a3df2e5ec92deacde38caa3f79568675b">mod_dd_slip::sdis</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable sdis</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00087">mod_dd_slip.f:87</a></div></div>
<div class="ttc" id="structmod__dd__slip_1_1dd_html"><div class="ttname"><a href="structmod__dd__slip_1_1dd.html">mod_dd_slip::dd</a></div><div class="ttdoc">Discrete dislocation object Contains all the variables relating to dislocations. </div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00106">mod_dd_slip.f:106</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_abcf9c3d7803c5c67dc3e0a84d482f0e5"><div class="ttname"><a href="namespacemod__dd__slip.html#abcf9c3d7803c5c67dc3e0a84d482f0e5">mod_dd_slip::gen_obstacles</a></div><div class="ttdeci">subroutine gen_obstacles</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01928">mod_dd_slip.f:1928</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ad8ebdc112d561b2fc072a77bc9528ced"><div class="ttname"><a href="namespacemod__dd__slip.html#ad8ebdc112d561b2fc072a77bc9528ced">mod_dd_slip::n_active_slip</a></div><div class="ttdeci">integer n_active_slip</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00028">mod_dd_slip.f:28</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a709b2b526f08c78a4d677d7e527dd3dd"><div class="ttname"><a href="namespacemod__dd__slip.html#a709b2b526f08c78a4d677d7e527dd3dd">mod_dd_slip::mxnnuc</a></div><div class="ttdeci">integer mxnnuc</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00053">mod_dd_slip.f:53</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a048140a438fd917252a83405fee5f613"><div class="ttname"><a href="namespacemod__dd__slip.html#a048140a438fd917252a83405fee5f613">mod_dd_slip::rmdisl_g</a></div><div class="ttdeci">subroutine rmdisl_g(i, islp)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00544">mod_dd_slip.f:544</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a57e6d391a6bd2870b02b5b0738872a17"><div class="ttname"><a href="namespacemod__dd__slip.html#a57e6d391a6bd2870b02b5b0738872a17">mod_dd_slip::elem_slip</a></div><div class="ttdeci">integer, dimension(:), allocatable elem_slip</div><div class="ttdoc">For elements in the DB this contains the slip plane number. </div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00041">mod_dd_slip.f:41</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a2b481a5fc03033c09e15385fde823efd"><div class="ttname"><a href="namespacemod__dd__slip.html#a2b481a5fc03033c09e15385fde823efd">mod_dd_slip::assign_new_global</a></div><div class="ttdeci">subroutine assign_new_global(xtip_move)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00567">mod_dd_slip.f:567</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aaf733690b66cf5dcca681c4e7712d9c9"><div class="ttname"><a href="namespacemod__dd__slip.html#aaf733690b66cf5dcca681c4e7712d9c9">mod_dd_slip::plot_slip</a></div><div class="ttdeci">subroutine plot_slip</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01655">mod_dd_slip.f:1655</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a9f46d3bb0ad2b69b394ca5d224221991"><div class="ttname"><a href="namespacemod__dd__slip.html#a9f46d3bb0ad2b69b394ca5d224221991">mod_dd_slip::nucleate_atomistic_disl</a></div><div class="ttdeci">subroutine nucleate_atomistic_disl(islp, s_disl, th_e, th_s, bv)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01196">mod_dd_slip.f:1196</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac3c28d1ffa56c0591838fb4820e32971"><div class="ttname"><a href="namespacemod__dd__slip.html#ac3c28d1ffa56c0591838fb4820e32971">mod_dd_slip::yslp</a></div><div class="ttdeci">double precision, dimension(:), allocatable yslp</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00038">mod_dd_slip.f:38</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html"><div class="ttname"><a href="namespacemod__dd__slip.html">mod_dd_slip</a></div><div class="ttdoc">— This module contains the entire DD methodology — Generate slip planes — Generate sources to a gi...</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00011">mod_dd_slip.f:11</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aa4b7a7f8a98600705ce9a524cdfaf4e6"><div class="ttname"><a href="namespacemod__dd__slip.html#aa4b7a7f8a98600705ce9a524cdfaf4e6">mod_dd_slip::crdisl</a></div><div class="ttdeci">subroutine crdisl(si, slim, islp, bi, nuc_num)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l01227">mod_dd_slip.f:1227</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a45c92219d97f2ed21739fe0cb87e191d"><div class="ttname"><a href="namespacemod__dd__slip.html#a45c92219d97f2ed21739fe0cb87e191d">mod_dd_slip::nnuc</a></div><div class="ttdeci">integer, dimension(:), allocatable nnuc</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00054">mod_dd_slip.f:54</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a6d223b07c98db2260f487aeb2014a81d"><div class="ttname"><a href="namespacemod__dd__slip.html#a6d223b07c98db2260f487aeb2014a81d">mod_dd_slip::tau_obs</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable tau_obs</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00071">mod_dd_slip.f:71</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a215656c7e607289d792ab455f8d06337"><div class="ttname"><a href="namespacemod__dd__slip.html#a215656c7e607289d792ab455f8d06337">mod_dd_slip::blen</a></div><div class="ttdeci">double precision blen</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a24a5651f5bc0e1dc43d73192293477e6"><div class="ttname"><a href="namespacemod__dd__slip.html#a24a5651f5bc0e1dc43d73192293477e6">mod_dd_slip::avg_source_str</a></div><div class="ttdeci">double precision avg_source_str</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00031">mod_dd_slip.f:31</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_aa9b6bdf8069606d789cdd50a14fc71fb"><div class="ttname"><a href="namespacemod__dd__slip.html#aa9b6bdf8069606d789cdd50a14fc71fb">mod_dd_slip::slipspc</a></div><div class="ttdeci">integer slipspc</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00043">mod_dd_slip.f:43</a></div></div>
<div class="ttc" id="fem__alan_8f_html_a7b711d38a8c3b46a70da0f46aa130b33"><div class="ttname"><a href="fem__alan_8f.html#a7b711d38a8c3b46a70da0f46aa130b33">fe_stress</a></div><div class="ttdeci">subroutine fe_stress(lmn, rhs, s_out)</div><div class="ttdef"><b>Definition:</b> <a href="fem__alan_8f_source.html#l00461">fem_alan.f:461</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ae5113e417d775c63727f6ac86255d34d"><div class="ttname"><a href="namespacemod__dd__slip.html#ae5113e417d775c63727f6ac86255d34d">mod_dd_slip::locphi</a></div><div class="ttdeci">integer, dimension(mxnslp) locphi</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00027">mod_dd_slip.f:27</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a1119fd6db7a709a15216dbee609cae35"><div class="ttname"><a href="namespacemod__dd__slip.html#a1119fd6db7a709a15216dbee609cae35">mod_dd_slip::d</a></div><div class="ttdeci">double precision d</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a26d5920aca346c3ed3de15f7391a3392"><div class="ttname"><a href="namespacemod__dd__slip.html#a26d5920aca346c3ed3de15f7391a3392">mod_dd_slip::nloop</a></div><div class="ttdeci">integer nloop</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00084">mod_dd_slip.f:84</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a83d7aa286ea628f8388281a435d91ce6"><div class="ttname"><a href="namespacemod__dd__slip.html#a83d7aa286ea628f8388281a435d91ce6">mod_dd_slip::xle</a></div><div class="ttdeci">double precision xle</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00056">mod_dd_slip.f:56</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a6ebc2746ce470503e03c1a07a8e14359"><div class="ttname"><a href="namespacemod__dd__slip.html#a6ebc2746ce470503e03c1a07a8e14359">mod_dd_slip::mxnslp</a></div><div class="ttdeci">integer mxnslp</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00012">mod_dd_slip.f:12</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a2ae10fac283054525708028b9d53377b"><div class="ttname"><a href="namespacemod__dd__slip.html#a2ae10fac283054525708028b9d53377b">mod_dd_slip::e_dd</a></div><div class="ttdeci">double precision e_dd</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00035">mod_dd_slip.f:35</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a3e59e48af6f038bd49856929e8604bf9"><div class="ttname"><a href="namespacemod__dd__slip.html#a3e59e48af6f038bd49856929e8604bf9">mod_dd_slip::inslip</a></div><div class="ttdeci">integer, dimension(3) inslip</div><div class="ttdoc">in burgers vectors </div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00043">mod_dd_slip.f:43</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a4c14f1bf834edadb70e33d37b752b841"><div class="ttname"><a href="namespacemod__dd__slip.html#a4c14f1bf834edadb70e33d37b752b841">mod_dd_slip::rdis</a></div><div class="ttdeci">double precision, dimension(:,:,:), allocatable rdis</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00090">mod_dd_slip.f:90</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ab33a818ba512c69f5de4b9f3ae923ece"><div class="ttname"><a href="namespacemod__dd__slip.html#ab33a818ba512c69f5de4b9f3ae923ece">mod_dd_slip::xmin1</a></div><div class="ttdeci">subroutine xmin1(x, xlist, n, xhold, inuc)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02032">mod_dd_slip.f:2032</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a8c9b798cdd4915fbb6b49873d9d6331f"><div class="ttname"><a href="namespacemod__dd__slip.html#a8c9b798cdd4915fbb6b49873d9d6331f">mod_dd_slip::tot_source</a></div><div class="ttdeci">integer tot_source</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00028">mod_dd_slip.f:28</a></div></div>
<div class="ttc" id="feaplib_8f_html_ac744a184cbe7429abdc78291e16436e9"><div class="ttname"><a href="feaplib_8f.html#ac744a184cbe7429abdc78291e16436e9">next</a></div><div class="ttdeci">function next(last, input)</div><div class="ttdef"><b>Definition:</b> <a href="feaplib_8f_source.html#l00059">feaplib.f:59</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac10e83dfde5eab5d21ac1e48d04ffd58"><div class="ttname"><a href="namespacemod__dd__slip.html#ac10e83dfde5eab5d21ac1e48d04ffd58">mod_dd_slip::elem_source</a></div><div class="ttdeci">integer, dimension(:,:), allocatable elem_source</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00065">mod_dd_slip.f:65</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ae516f5f99cd702f7ab3000d65fd31e84"><div class="ttname"><a href="namespacemod__dd__slip.html#ae516f5f99cd702f7ab3000d65fd31e84">mod_dd_slip::rmarin</a></div><div class="ttdeci">subroutine rmarin(IJ, KL)</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l02133">mod_dd_slip.f:2133</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_a5e1e956db511de382099db6d11a78716"><div class="ttname"><a href="namespacemod__dd__slip.html#a5e1e956db511de382099db6d11a78716">mod_dd_slip::tincr</a></div><div class="ttdeci">double precision tincr</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00019">mod_dd_slip.f:19</a></div></div>
<div class="ttc" id="namespacemod__dd__slip_html_ac8bbc8f48c207c01d23b3f230298835f"><div class="ttname"><a href="namespacemod__dd__slip.html#ac8bbc8f48c207c01d23b3f230298835f">mod_dd_slip::dlim</a></div><div class="ttdeci">double precision dlim</div><div class="ttdef"><b>Definition:</b> <a href="mod__dd__slip_8f_source.html#l00091">mod_dd_slip.f:91</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 26 2015 11:38:37 for CADD by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
